<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>opqua.model &mdash; Opqua 1.0.2 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=1ed6394b"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Opqua
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../requirements_and_installation.html">Requirements and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model_documentation.html"><code class="docutils literal notranslate"><span class="pre">Model</span></code> Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../API.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Opqua</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">opqua.model</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for opqua.model</h1><div class="highlight"><pre>
<span></span>
<span class="sd">&quot;&quot;&quot;Contains class Model; main class user interacts with.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">textdistance</span> <span class="k">as</span> <span class="nn">td</span>
<span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="kn">import</span> <span class="nn">copy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">joblib</span> <span class="k">as</span> <span class="nn">jl</span>

<span class="kn">from</span> <span class="nn">opqua.internal.host</span> <span class="kn">import</span> <span class="n">Host</span>
<span class="kn">from</span> <span class="nn">opqua.internal.vector</span> <span class="kn">import</span> <span class="n">Vector</span>
<span class="kn">from</span> <span class="nn">opqua.internal.population</span> <span class="kn">import</span> <span class="n">Population</span>
<span class="kn">from</span> <span class="nn">opqua.internal.setup</span> <span class="kn">import</span> <span class="n">Setup</span>
<span class="kn">from</span> <span class="nn">opqua.internal.intervention</span> <span class="kn">import</span> <span class="n">Intervention</span>
<span class="kn">from</span> <span class="nn">opqua.internal.gillespie</span> <span class="kn">import</span> <span class="n">Gillespie</span>
<span class="kn">from</span> <span class="nn">opqua.internal.data</span> <span class="kn">import</span> <span class="n">saveToDf</span><span class="p">,</span> <span class="n">getPathogens</span><span class="p">,</span> <span class="n">getProtections</span><span class="p">,</span> \
    <span class="n">getPathogenDistanceHistoryDf</span>
<span class="kn">from</span> <span class="nn">opqua.internal.plot</span> <span class="kn">import</span> <span class="n">populationsPlot</span><span class="p">,</span> <span class="n">compartmentPlot</span><span class="p">,</span> \
    <span class="n">compositionPlot</span><span class="p">,</span> <span class="n">clustermap</span>

<div class="viewcode-block" id="Model">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model">[docs]</a>
<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class defines a Model.</span>

<span class="sd">    This is the main class that the user interacts with.</span>

<span class="sd">    The Model class contains populations, setups, and interventions to be used</span>
<span class="sd">    in simulation. Also contains groups of hosts/vectors for manipulations and</span>
<span class="sd">    stores model history as snapshots for each time point.</span>

<span class="sd">    **CONSTANTS:**</span>

<span class="sd">    - `CB_PALETTE`: a colorblind-friendly 8-color color scheme.</span>
<span class="sd">    - `DEF_CMAP`: a colormap object for Seaborn plots.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        populations: dictionary with keys=population IDs, values=Population</span>
<span class="sd">            objects.</span>
<span class="sd">        setups: dictionary with keys=setup IDs, values=Setup objects.</span>
<span class="sd">        interventions: contains model interventions in the order they will occur.</span>
<span class="sd">        groups: dictionary with keys=group IDs, values=lists of hosts/vectors.</span>
<span class="sd">        history: dictionary with keys=time values, values=Model objects that</span>
<span class="sd">            are snapshots of Model at that timepoint.</span>
<span class="sd">        t_var: variable that tracks time in simulations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CONSTANTS ###</span>
    <span class="c1">### Color scheme constants ###</span>
    <span class="n">CB_PALETTE</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#E69F00&quot;</span><span class="p">,</span> <span class="s2">&quot;#56B4E9&quot;</span><span class="p">,</span> <span class="s2">&quot;#009E73&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;#F0E442&quot;</span><span class="p">,</span> <span class="s2">&quot;#0072B2&quot;</span><span class="p">,</span> <span class="s2">&quot;#D55E00&quot;</span><span class="p">,</span> <span class="s2">&quot;#CC79A7&quot;</span><span class="p">,</span> <span class="s2">&quot;#999999&quot;</span><span class="p">]</span>
     <span class="c1"># www.cookbook-r.com/Graphs/Colors_(ggplot2)/#a-colorblind-friendly-palette</span>
     <span class="c1"># http://jfly.iam.u-tokyo.ac.jp/color/</span>

    <span class="n">DEF_CMAP</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">cubehelix_palette</span><span class="p">(</span>
        <span class="n">start</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">rot</span><span class="o">=-</span><span class="mf">.75</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>


    <span class="c1">### CLASS CONSTRUCTOR ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new Model object.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># dictionary with keys=population IDs, values=Population objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setups</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># dictionary with keys=setup IDs, values=Setup objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># contains model interventions in the order they will occur</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># dictionary with keys=group IDs, values=lists of hosts/vectors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># dictionary with keys=time values, values=Model objects that are</span>
            <span class="c1"># snapshots of Model at that timepoint</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_trackers</span> <span class="o">=</span> <span class="p">{</span>
                <span class="c1"># dictionary keeping track of some global indicators over all</span>
                <span class="c1"># the course of the simulation</span>
            <span class="s1">&#39;num_events&#39;</span> <span class="p">:</span> <span class="p">{</span> <span class="nb">id</span><span class="p">:</span><span class="mi">0</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">Gillespie</span><span class="o">.</span><span class="n">EVENT_IDS</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="p">},</span>
                <span class="c1"># tracks the number of each kind of event in the simulation</span>
            <span class="s1">&#39;last_event_time&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="c1"># time point at which the last event in the simulation happened</span>
            <span class="s1">&#39;genomes_seen&#39;</span> <span class="p">:</span> <span class="p">[],</span>
                <span class="c1"># list of all unique genomes that have appeared in the</span>
                <span class="c1"># simulation</span>
            <span class="s1">&#39;custom_conditions&#39;</span> <span class="p">:</span> <span class="p">{}</span>
                <span class="c1"># dictionary with keys=ID of custom condition, values=lists of</span>
                <span class="c1"># times; every time True is returned by a function in</span>
                <span class="c1"># custom_condition_trackers, the simulation time will be stored</span>
                <span class="c1"># under the corresponding ID inside</span>
                <span class="c1"># global_trackers[&#39;custom_condition&#39;]</span>
            <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">custom_condition_trackers</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># dictionary with keys=ID of custom condition, values=functions that</span>
            <span class="c1"># take a Model object as argument and return True or False; every</span>
            <span class="c1"># time True is returned by a function in custom_condition_trackers,</span>
            <span class="c1"># the simulation time will be stored under the corresponding ID</span>
            <span class="c1"># inside global_trackers[&#39;custom_condition&#39;]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">t_var</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># used as time variable during simulation</span>

    <span class="c1">### MODEL METHODS ###</span>

    <span class="c1">### Model initialization and simulation: ###</span>

<div class="viewcode-block" id="Model.setRandomSeed">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.setRandomSeed">[docs]</a>
    <span class="k">def</span> <span class="nf">setRandomSeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set random seed for numpy random number generator.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            seed (int): int for the random seed to be passed to numpy.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.newSetup">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.newSetup">[docs]</a>
    <span class="k">def</span> <span class="nf">newSetup</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">preset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">num_loci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">possible_alleles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">fitnessHost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">contactHost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">receiveContactHost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">mortalityHost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">natalityHost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">recoveryHost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">migrationHost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">populationContactHost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">receivePopulationContactHost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">mutationHost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">recombinationHost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitnessVector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">contactVector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">receiveContactVector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mortalityVector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">natalityVector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">recoveryVector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">migrationVector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">populationContactVector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">receivePopulationContactVector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">mutationVector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">recombinationVector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">contact_rate_host_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">transmission_efficiency_host_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">transmission_efficiency_vector_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">contact_rate_host_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">transmission_efficiency_host_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">mean_inoculum_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mean_inoculum_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">recovery_rate_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">recovery_rate_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">mortality_rate_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mortality_rate_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">recombine_in_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">recombine_in_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">num_crossover_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_crossover_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">mutate_in_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mutate_in_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">death_rate_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">death_rate_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">birth_rate_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">birth_rate_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">vertical_transmission_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vertical_transmission_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">inherit_protection_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inherit_protection_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">protection_upon_recovery_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">protection_upon_recovery_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new `Setup`, save it in setups dict under given name.</span>

<span class="sd">        Two preset setups exist: &quot;vector-borne&quot; and &quot;host-host&quot;. You may select</span>
<span class="sd">        one of the preset setups with the preset keyword argument and then</span>
<span class="sd">        modify individual parameters with additional keyword arguments, without</span>
<span class="sd">        having to specify all of them.</span>

<span class="sd">        **&quot;host-host&quot;:**</span>

<span class="sd">        - `num_loci` = 10</span>
<span class="sd">        - `possible_alleles` = &#39;ATCG&#39;</span>
<span class="sd">        - `fitnessHost` = (lambda g: 1)</span>
<span class="sd">        - `contactHost` = (lambda g: 1)</span>
<span class="sd">        - `receiveContactHost` = (lambda g: 1)</span>
<span class="sd">        - `mortalityHost` = (lambda g: 1)</span>
<span class="sd">        - `natalityHost` = (lambda g: 1)</span>
<span class="sd">        - `recoveryHost` = (lambda g: 1)</span>
<span class="sd">        - `migrationHost` = (lambda g: 1)</span>
<span class="sd">        - `populationContactHost` = (lambda g: 1)</span>
<span class="sd">        - `receivePopulationContactHost` = (lambda g: 1)</span>
<span class="sd">        - `mutationHost` = (lambda g: 1)</span>
<span class="sd">        - `recombinationHost` = (lambda g: 1)</span>
<span class="sd">        - `fitnessVector` = (lambda g: 1)</span>
<span class="sd">        - `contactVector` = (lambda g: 1)</span>
<span class="sd">        - `receiveContactVector` = (lambda g: 1)</span>
<span class="sd">        - `mortalityVector` = (lambda g: 1)</span>
<span class="sd">        - `natalityVector` = (lambda g: 1)</span>
<span class="sd">        - `recoveryVector` = (lambda g: 1)</span>
<span class="sd">        - `migrationVector` = (lambda g: 1)</span>
<span class="sd">        - `populationContactVector` = (lambda g: 1)</span>
<span class="sd">        - `receivePopulationContactVector` = (lambda g: 1)</span>
<span class="sd">        - `mutationVector` = (lambda g: 1)</span>
<span class="sd">        - `recombinationVector` = (lambda g: 1)</span>
<span class="sd">        - `contact_rate_host_vector` = 0</span>
<span class="sd">        - `transmission_efficiency_host_vector` = 0</span>
<span class="sd">        - `transmission_efficiency_vector_host` = 0</span>
<span class="sd">        - `contact_rate_host_host` = 2e-1</span>
<span class="sd">        - `transmission_efficiency_host_host` = 1</span>
<span class="sd">        - `mean_inoculum_host` = 1e1</span>
<span class="sd">        - `mean_inoculum_vector` = 0</span>
<span class="sd">        - `recovery_rate_host` = 1e-1</span>
<span class="sd">        - `recovery_rate_vector` = 0</span>
<span class="sd">        - `mortality_rate_host` = 0</span>
<span class="sd">        - `mortality_rate_vector` = 0</span>
<span class="sd">        - `recombine_in_host` = 1e-4</span>
<span class="sd">        - `recombine_in_vector` = 0</span>
<span class="sd">        - `num_crossover_host` = 1</span>
<span class="sd">        - `num_crossover_vector` = 0</span>
<span class="sd">        - `mutate_in_host` = 1e-6</span>
<span class="sd">        - `mutate_in_vector` = 0</span>
<span class="sd">        - `death_rate_host` = 0</span>
<span class="sd">        - `death_rate_vector` = 0</span>
<span class="sd">        - `birth_rate_host` = 0</span>
<span class="sd">        - `birth_rate_vector` = 0</span>
<span class="sd">        - `vertical_transmission_host` = 0</span>
<span class="sd">        - `vertical_transmission_vector` = 0</span>
<span class="sd">        - `inherit_protection_host` = 0</span>
<span class="sd">        - `inherit_protection_vector` = 0</span>
<span class="sd">        - `protection_upon_recovery_host` = None</span>
<span class="sd">        - `protection_upon_recovery_vector` = None</span>

<span class="sd">        **&quot;vector-borne&quot;:**</span>

<span class="sd">        - `num_loci` = 10</span>
<span class="sd">        - `possible_alleles` = &#39;ATCG&#39;</span>
<span class="sd">        - `fitnessHost` = (lambda g: 1)</span>
<span class="sd">        - `contactHost` = (lambda g: 1)</span>
<span class="sd">        - `receiveContactHost` = (lambda g: 1)</span>
<span class="sd">        - `mortalityHost` = (lambda g: 1)</span>
<span class="sd">        - `natalityHost` = (lambda g: 1)</span>
<span class="sd">        - `recoveryHost` = (lambda g: 1)</span>
<span class="sd">        - `migrationHost` = (lambda g: 1)</span>
<span class="sd">        - `populationContactHost` = (lambda g: 1)</span>
<span class="sd">        - `receivePopulationContactHost` = (lambda g: 1)</span>
<span class="sd">        - `mutationHost` = (lambda g: 1)</span>
<span class="sd">        - `recombinationHost` = (lambda g: 1)</span>
<span class="sd">        - `fitnessVector` = (lambda g: 1)</span>
<span class="sd">        - `contactVector` = (lambda g: 1)</span>
<span class="sd">        - `receiveContactVector` = (lambda g: 1)</span>
<span class="sd">        - `mortalityVector` = (lambda g: 1)</span>
<span class="sd">        - `natalityVector` = (lambda g: 1)</span>
<span class="sd">        - `recoveryVector` = (lambda g: 1)</span>
<span class="sd">        - `migrationVector` = (lambda g: 1)</span>
<span class="sd">        - `populationContactVector` = (lambda g: 1)</span>
<span class="sd">        - `receivePopulationContactVector` = (lambda g: 1)</span>
<span class="sd">        - `mutationVector` = (lambda g: 1)</span>
<span class="sd">        - `recombinationVector` = (lambda g: 1)</span>
<span class="sd">        - `contact_rate_host_vector` = 2e-1</span>
<span class="sd">        - `transmission_efficiency_host_vector` = 1</span>
<span class="sd">        - `transmission_efficiency_vector_host` = 1</span>
<span class="sd">        - `contact_rate_host_host` = 0</span>
<span class="sd">        - `transmission_efficiency_host_host` = 0</span>
<span class="sd">        - `mean_inoculum_host` = 1e2</span>
<span class="sd">        - `mean_inoculum_vector` = 1e0</span>
<span class="sd">        - `recovery_rate_host` = 1e-1</span>
<span class="sd">        - `recovery_rate_vector` = 1e-1</span>
<span class="sd">        - `mortality_rate_host` = 0</span>
<span class="sd">        - `mortality_rate_vector` = 0</span>
<span class="sd">        - `recombine_in_host` = 0</span>
<span class="sd">        - `recombine_in_vector` = 1e-4</span>
<span class="sd">        - `num_crossover_host` = 0</span>
<span class="sd">        - `num_crossover_vector` = 1</span>
<span class="sd">        - `mutate_in_host` = 1e-6</span>
<span class="sd">        - `mutate_in_vector` = 0</span>
<span class="sd">        - `death_rate_host` = 0</span>
<span class="sd">        - `death_rate_vector` = 0</span>
<span class="sd">        - `birth_rate_host` = 0</span>
<span class="sd">        - `birth_rate_vector` = 0</span>
<span class="sd">        - `vertical_transmission_host` = 0</span>
<span class="sd">        - `vertical_transmission_vector` = 0</span>
<span class="sd">        - `inherit_protection_host` = 0</span>
<span class="sd">        - `inherit_protection_vector` = 0</span>
<span class="sd">        - `protection_upon_recovery_host` = None</span>
<span class="sd">        - `protection_upon_recovery_vector` = None</span>

<span class="sd">        Arguments:</span>
<span class="sd">            name (String): name of setup to be used as a key in model setups dictionary.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            preset (None or String): preset setup to be used: &quot;vector-borne&quot; or &quot;host-host&quot;, if</span>
<span class="sd">                None, must define all other keyword arguments. Defaults to None.</span>
<span class="sd">            num_loci (int&gt;0): length of each pathogen genome string.</span>
<span class="sd">            possible_alleles (String or list of Strings with num_loci elements): set of possible </span>
<span class="sd">                characters in all genome string, or at each position in genome string. </span>
<span class="sd">            fitnessHost (callable, takes a String argument and returns a number &gt;= 0): function </span>
<span class="sd">                that evaluates relative fitness in head-to-head competition for different genomes </span>
<span class="sd">                within the same host.</span>
<span class="sd">            contactHost (callable, takes a String argument and returns a number 0-1): function that </span>
<span class="sd">                returns coefficient modifying probability of a given host being chosen to be the </span>
<span class="sd">                infector in a contact event, based on genome sequence of pathogen.</span>
<span class="sd">            receiveContactHost (callable, takes a String argument and returns a number 0-1): function </span>
<span class="sd">                that returns coefficient modifying probability of a given host being chosen to be </span>
<span class="sd">                the infected in a contact event, based on genome sequence of pathogen.</span>
<span class="sd">            mortalityHost (callable, takes a String argument and returns a number 0-1): function that </span>
<span class="sd">                returns coefficient modifying death rate for a given host, based on genome sequence </span>
<span class="sd">                of pathogen.</span>
<span class="sd">            natalityHost (callable, takes a String argument and returns a number 0-1): function that </span>
<span class="sd">                returns coefficient modifying birth rate for a given host, based on genome sequence </span>
<span class="sd">                of pathogen.</span>
<span class="sd">            recoveryHost (callable, takes a String argument and returns a number 0-1): function that </span>
<span class="sd">                returns coefficient modifying recovery rate for a given host based on genome sequence </span>
<span class="sd">                of pathogen.</span>
<span class="sd">            migrationHost (callable, takes a String argument and returns a number 0-1): function that </span>
<span class="sd">                returns coefficient modifying migration rate for a given host based on genome sequence </span>
<span class="sd">                of pathogen.</span>
<span class="sd">            populationContactHost (callable, takes a String argument and returns a number 0-1): function </span>
<span class="sd">                that returns coefficient modifying population contact rate for a given host based on </span>
<span class="sd">                genome sequence of pathogen.</span>
<span class="sd">            mutationHost (callable, takes a String argument and returns a number 0-1): function that </span>
<span class="sd">                returns coefficient modifying mutation rate for a given host based on genome sequence </span>
<span class="sd">                of pathogen.</span>
<span class="sd">            recombinationHost (callable, takes a String argument and returns a number 0-1): function </span>
<span class="sd">                that returns coefficient modifying recombination rate for a given host based on genome </span>
<span class="sd">                sequence of pathogen.</span>
<span class="sd">            fitnessVector (callable, takes a String argument and returns a number &gt;=0): function that </span>
<span class="sd">                evaluates relative fitness in head-to-head competition for different genomes within </span>
<span class="sd">                the same vector.</span>
<span class="sd">            contactVector (callable, takes a String argument and returns a number 0-1): function that </span>
<span class="sd">                returns coefficient modifying probability of a given vector being chosen to be the </span>
<span class="sd">                infector in a contact event, based on genome sequence of pathogen.</span>
<span class="sd">            receiveContactVector (callable, takes a String argument and returns a number 0-1): function </span>
<span class="sd">                that returns coefficient modifying probability of a given vector being chosen to be the </span>
<span class="sd">                infected in a contact event, based on genome sequence of pathogen.</span>
<span class="sd">            mortalityVector (callable, takes a String argument and returns a number 0-1): function that </span>
<span class="sd">                returns coefficient modifying death rate for a given vector, based on genome sequence </span>
<span class="sd">                of pathogen.</span>
<span class="sd">            natalityVector (callable, takes a String argument and returns a number 0-1): function that </span>
<span class="sd">                returns coefficient modifying birth rate for a given vector, based on genome sequence </span>
<span class="sd">                of pathogen.</span>
<span class="sd">            recoveryVector (callable, takes a String argument and returns a number 0-1): function that </span>
<span class="sd">                returns coefficient modifying recovery rate for a given vector based on genome sequence </span>
<span class="sd">                of pathogen.</span>
<span class="sd">            migrationVector (callable, takes a String argument and returns a number 0-1): function that </span>
<span class="sd">                returns coefficient modifying migration rate for a given vector based on genome sequence </span>
<span class="sd">                of pathogen.</span>
<span class="sd">            populationContactVector (callable, takes a String argument and returns a number 0-1): function </span>
<span class="sd">                that returns coefficient modifying population contact rate for a given vector based on </span>
<span class="sd">                genome sequence of pathogen.</span>
<span class="sd">            mutationVector (callable, takes a String argument and returns a number 0-1): function that </span>
<span class="sd">                returns coefficient modifying mutation rate for a given vector based on genome sequence </span>
<span class="sd">                of pathogen.</span>
<span class="sd">            recombinationVector (callable, takes a String argument and returns a number 0-1): function </span>
<span class="sd">                that returns coefficient modifying recombination rate for a given vector based on genome </span>
<span class="sd">                sequence of pathogen.</span>
<span class="sd">            contact_rate_host_vector (number &gt;= 0): rate of host-vector contact events, not necessarily </span>
<span class="sd">                transmission, assumes constant population density; evts/time.</span>
<span class="sd">            transmission_efficiency_host_vector (float): fraction of host-vector contacts</span>
<span class="sd">                that result in successful transmission.</span>
<span class="sd">            transmission_efficiency_vector_host (float): fraction of vector-host contacts</span>
<span class="sd">                that result in successful transmission.</span>
<span class="sd">            contact_rate_host_host (number &gt;= 0): rate of host-host contact events, not</span>
<span class="sd">                necessarily transmission, assumes constant population density; evts/time.</span>
<span class="sd">            transmission_efficiency_host_host (float): fraction of host-host contacts</span>
<span class="sd">                    that result in successful transmission.</span>
<span class="sd">            mean_inoculum_host (int &gt;= 0): mean number of pathogens that are transmitted from</span>
<span class="sd">                a vector or host into a new host during a contact event.</span>
<span class="sd">            mean_inoculum_vector (int &gt;= 0) mean number of pathogens that are transmitted</span>
<span class="sd">                from a host to a vector during a contact event.</span>
<span class="sd">            recovery_rate_host (number &gt;= 0): rate at which hosts clear all pathogens;</span>
<span class="sd">                1/time.</span>
<span class="sd">            recovery_rate_vector (number &gt;= 0): rate at which vectors clear all pathogens</span>
<span class="sd">                1/time.</span>
<span class="sd">            recovery_rate_vector (number &gt;= 0): rate at which vectors clear all pathogens</span>
<span class="sd">                1/time.</span>
<span class="sd">            mortality_rate_host (number 0-1): rate at which infected hosts die from disease.</span>
<span class="sd">            mortality_rate_vector (number 0-1): rate at which infected vectors die from</span>
<span class="sd">                disease.</span>
<span class="sd">            recombine_in_host (number &gt;= 0): rate at which recombination occurs in host;</span>
<span class="sd">                evts/time.</span>
<span class="sd">            recombine_in_vector (number &gt;= 0): rate at which recombination occurs in vector;</span>
<span class="sd">                evts/time.</span>
<span class="sd">            num_crossover_host (number &gt;= 0): mean of a Poisson distribution modeling the number</span>
<span class="sd">                of crossover events of host recombination events.</span>
<span class="sd">            num_crossover_vector (number &gt;= 0): mean of a Poisson distribution modeling the</span>
<span class="sd">                number of crossover events of vector recombination events.</span>
<span class="sd">            mutate_in_host (number &gt;= 0): rate at which mutation occurs in host; evts/time.</span>
<span class="sd">            mutate_in_vector (number &gt;= 0): rate at which mutation occurs in vector; evts/time.</span>
<span class="sd">            death_rate_host (number &gt;= 0): natural host death rate; 1/time.</span>
<span class="sd">            death_rate_vector (number &gt;= 0): natural vector death rate; 1/time.</span>
<span class="sd">            birth_rate_host (number &gt;= 0): infected host birth rate; 1/time.</span>
<span class="sd">            birth_rate_vector (number &gt;= 0): infected vector birth rate; 1/time.</span>
<span class="sd">            vertical_transmission_host (number 0-1): probability that a host is infected by its</span>
<span class="sd">                parent at birth.</span>
<span class="sd">            vertical_transmission_vector (number 0-1): probability that a vector is infected by</span>
<span class="sd">                its parent at birth.</span>
<span class="sd">            inherit_protection_host (number 0-1): probability that a host inherits all</span>
<span class="sd">                protection sequences from its parent.</span>
<span class="sd">            inherit_protection_vector (number 0-1): probability that a vector inherits all</span>
<span class="sd">                protection sequences from its parent.</span>
<span class="sd">            protection_upon_recovery_host (None or array-like of length 2 with int 0-num_loci): defines </span>
<span class="sd">                indexes in genome string that define substring to be added to host protection sequences </span>
<span class="sd">                after recovery.</span>
<span class="sd">            protection_upon_recovery_vector (None or array-like of length 2 with int 0-num_loci): defines </span>
<span class="sd">                indexes in genome string that define substring to be added to vector protection sequences </span>
<span class="sd">                after recovery.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">preset</span> <span class="o">==</span> <span class="s2">&quot;vector-borne&quot;</span><span class="p">:</span>
            <span class="n">num_loci</span> <span class="o">=</span> <span class="mi">10</span> <span class="k">if</span> <span class="n">num_loci</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">num_loci</span>
            <span class="n">possible_alleles</span> <span class="o">=</span> \
                <span class="s1">&#39;ATCG&#39;</span> <span class="k">if</span> <span class="n">possible_alleles</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">possible_alleles</span>
            <span class="n">fitnessHost</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">fitnessHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fitnessHost</span>
            <span class="n">contactHost</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">contactHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">contactHost</span>
            <span class="n">receiveContactHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">receiveContactHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">receiveContactHost</span>
            <span class="n">mortalityHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">mortalityHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mortalityHost</span>
            <span class="n">natalityHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">natalityHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">natalityHost</span>
            <span class="n">recoveryHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">recoveryHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recoveryHost</span>
            <span class="n">migrationHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">migrationHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">migrationHost</span>
            <span class="n">populationContactHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">populationContactHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">populationContactHost</span>
            <span class="n">receivePopulationContactHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">receivePopulationContactHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">receivePopulationContactHost</span>
            <span class="n">mutationHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">mutationHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mutationHost</span>
            <span class="n">recombinationHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">recombinationHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recombinationHost</span>
            <span class="n">fitnessVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">fitnessVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fitnessVector</span>
            <span class="n">contactVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">contactVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">contactVector</span>
            <span class="n">receiveContactVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">receiveContactVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">receiveContactVector</span>
            <span class="n">mortalityVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">mortalityVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mortalityVector</span>
            <span class="n">natalityVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">natalityVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">natalityVector</span>
            <span class="n">recoveryVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">recoveryVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recoveryVector</span>
            <span class="n">migrationVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">migrationVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">migrationVector</span>
            <span class="n">populationContactVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">populationContactVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">populationContactVector</span>
            <span class="n">receivePopulationContactVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">receivePopulationContactVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">receivePopulationContactVector</span>
            <span class="n">mutationVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">mutationVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mutationVector</span>
            <span class="n">recombinationVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">recombinationVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recombinationVector</span>
            <span class="n">contact_rate_host_vector</span> <span class="o">=</span> \
                <span class="mf">2e-1</span> <span class="k">if</span> <span class="n">contact_rate_host_vector</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">contact_rate_host_vector</span>
            <span class="n">transmission_efficiency_host_vector</span> <span class="o">=</span> \
                <span class="mi">1</span> <span class="k">if</span> <span class="n">transmission_efficiency_host_vector</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">transmission_efficiency_host_vector</span>
            <span class="n">transmission_efficiency_vector_host</span> <span class="o">=</span> \
                <span class="mi">1</span> <span class="k">if</span> <span class="n">transmission_efficiency_vector_host</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">transmission_efficiency_vector_host</span>
            <span class="n">contact_rate_host_host</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">contact_rate_host_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">contact_rate_host_host</span>
            <span class="n">transmission_efficiency_host_host</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">transmission_efficiency_host_host</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">transmission_efficiency_host_host</span>
            <span class="n">mean_inoculum_host</span> <span class="o">=</span> \
                <span class="mf">1e2</span> <span class="k">if</span> <span class="n">mean_inoculum_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mean_inoculum_host</span>
            <span class="n">mean_inoculum_vector</span> <span class="o">=</span> \
                <span class="mi">1</span> <span class="k">if</span> <span class="n">mean_inoculum_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mean_inoculum_vector</span>
            <span class="n">recovery_rate_host</span> <span class="o">=</span> \
                <span class="mf">1e-1</span> <span class="k">if</span> <span class="n">recovery_rate_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recovery_rate_host</span>
            <span class="n">recovery_rate_vector</span> <span class="o">=</span> \
                <span class="mf">1e-1</span> <span class="k">if</span> <span class="n">recovery_rate_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recovery_rate_vector</span>
            <span class="n">mortality_rate_host</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">mortality_rate_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mortality_rate_host</span>
            <span class="n">mortality_rate_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">mortality_rate_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mortality_rate_vector</span>
            <span class="n">recombine_in_host</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">recombine_in_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recombine_in_host</span>
            <span class="n">recombine_in_vector</span> <span class="o">=</span> \
                <span class="mf">1e-4</span> <span class="k">if</span> <span class="n">recombine_in_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recombine_in_vector</span>
            <span class="n">num_crossover_host</span> <span class="o">=</span> <span class="mi">0</span> \
                <span class="k">if</span> <span class="n">num_crossover_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">num_crossover_host</span>
            <span class="n">num_crossover_vector</span> <span class="o">=</span> \
                <span class="mi">1</span> <span class="k">if</span> <span class="n">num_crossover_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">num_crossover_vector</span>
            <span class="n">mutate_in_host</span> <span class="o">=</span> <span class="mf">1e-6</span> <span class="k">if</span> <span class="n">mutate_in_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mutate_in_host</span>
            <span class="n">mutate_in_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">mutate_in_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mutate_in_vector</span>
            <span class="n">death_rate_host</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">death_rate_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">death_rate_host</span>
            <span class="n">death_rate_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">death_rate_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">death_rate_vector</span>
            <span class="n">birth_rate_host</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">birth_rate_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">birth_rate_host</span>
            <span class="n">birth_rate_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">birth_rate_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">birth_rate_vector</span>
            <span class="n">vertical_transmission_host</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">vertical_transmission_host</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">vertical_transmission_host</span>
            <span class="n">vertical_transmission_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">vertical_transmission_vector</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">vertical_transmission_vector</span>
            <span class="n">inherit_protection_host</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">inherit_protection_host</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">inherit_protection_host</span>
            <span class="n">inherit_protection_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">inherit_protection_vector</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">inherit_protection_vector</span>
            <span class="n">protection_upon_recovery_host</span> <span class="o">=</span> <span class="n">protection_upon_recovery_host</span>
            <span class="n">protection_upon_recovery_vector</span> <span class="o">=</span> <span class="n">protection_upon_recovery_vector</span>

        <span class="k">elif</span> <span class="n">preset</span> <span class="o">==</span> <span class="s2">&quot;host-host&quot;</span><span class="p">:</span>
            <span class="n">num_loci</span> <span class="o">=</span> <span class="mi">10</span> <span class="k">if</span> <span class="n">num_loci</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">num_loci</span>
            <span class="n">possible_alleles</span> <span class="o">=</span> \
                <span class="s1">&#39;ATCG&#39;</span> <span class="k">if</span> <span class="n">possible_alleles</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">possible_alleles</span>
            <span class="n">fitnessHost</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">fitnessHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fitnessHost</span>
            <span class="n">contactHost</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">contactHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">contactHost</span>
            <span class="n">receiveContactHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">receiveContactHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">receiveContactHost</span>
            <span class="n">mortalityHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">mortalityHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mortalityHost</span>
            <span class="n">natalityHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">natalityHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">natalityHost</span>
            <span class="n">recoveryHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">recoveryHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recoveryHost</span>
            <span class="n">migrationHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">migrationHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">migrationHost</span>
            <span class="n">populationContactHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">populationContactHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">populationContactHost</span>
            <span class="n">receivePopulationContactHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">receivePopulationContactHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">receivePopulationContactHost</span>
            <span class="n">mutationHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">mutationHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mutationHost</span>
            <span class="n">recombinationHost</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">recombinationHost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recombinationHost</span>
            <span class="n">fitnessVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">fitnessVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fitnessVector</span>
            <span class="n">contactVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">contactVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">contactVector</span>
            <span class="n">receiveContactVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">receiveContactVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">receiveContactVector</span>
            <span class="n">mortalityVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">mortalityVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mortalityVector</span>
            <span class="n">natalityVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">natalityVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">natalityVector</span>
            <span class="n">recoveryVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">recoveryVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recoveryVector</span>
            <span class="n">mortality_rate_host</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">mortality_rate_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mortality_rate_host</span>
            <span class="n">mortality_rate_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">mortality_rate_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mortality_rate_vector</span>
            <span class="n">migrationVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">migrationVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">migrationVector</span>
            <span class="n">populationContactVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">populationContactVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">populationContactVector</span>
            <span class="n">receivePopulationContactVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">receivePopulationContactVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">receivePopulationContactVector</span>
            <span class="n">mutationVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">mutationVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mutationVector</span>
            <span class="n">recombinationVector</span> <span class="o">=</span> \
                <span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">recombinationVector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recombinationVector</span>
            <span class="n">contact_rate_host_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">contact_rate_host_vector</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">contact_rate_host_vector</span>
            <span class="n">transmission_efficiency_host_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">transmission_efficiency_host_vector</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">transmission_efficiency_host_vector</span>
            <span class="n">transmission_efficiency_vector_host</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">transmission_efficiency_vector_host</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">transmission_efficiency_vector_host</span>
            <span class="n">contact_rate_host_host</span> <span class="o">=</span> \
                <span class="mf">2e-1</span> <span class="k">if</span> <span class="n">contact_rate_host_host</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">contact_rate_host_host</span>
            <span class="n">transmission_efficiency_host_host</span> <span class="o">=</span> \
                <span class="mi">1</span> <span class="k">if</span> <span class="n">transmission_efficiency_host_host</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">transmission_efficiency_host_host</span>
            <span class="n">mean_inoculum_host</span> <span class="o">=</span> \
                <span class="mf">1e1</span> <span class="k">if</span> <span class="n">mean_inoculum_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mean_inoculum_host</span>
            <span class="n">mean_inoculum_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">mean_inoculum_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mean_inoculum_vector</span>
            <span class="n">recovery_rate_host</span> <span class="o">=</span> \
                <span class="mf">1e-1</span> <span class="k">if</span> <span class="n">recovery_rate_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recovery_rate_host</span>
            <span class="n">recovery_rate_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">recovery_rate_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recovery_rate_vector</span>
            <span class="n">recombine_in_host</span> <span class="o">=</span> \
                <span class="mf">1e-4</span> <span class="k">if</span> <span class="n">recombine_in_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recombine_in_host</span>
            <span class="n">recombine_in_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">recombine_in_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">recombine_in_vector</span>
            <span class="n">num_crossover_host</span> <span class="o">=</span> <span class="mi">1</span> \
                <span class="k">if</span> <span class="n">num_crossover_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">num_crossover_host</span>
            <span class="n">num_crossover_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">num_crossover_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">num_crossover_vector</span>
            <span class="n">mutate_in_host</span> <span class="o">=</span> \
                <span class="mf">1e-6</span> <span class="k">if</span> <span class="n">mutate_in_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mutate_in_host</span>
            <span class="n">mutate_in_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">mutate_in_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mutate_in_vector</span>
            <span class="n">death_rate_host</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">death_rate_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">death_rate_host</span>
            <span class="n">death_rate_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">death_rate_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">death_rate_vector</span>
            <span class="n">birth_rate_host</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">birth_rate_host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">birth_rate_host</span>
            <span class="n">birth_rate_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">birth_rate_vector</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">birth_rate_vector</span>
            <span class="n">vertical_transmission_host</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">vertical_transmission_host</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">vertical_transmission_host</span>
            <span class="n">vertical_transmission_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">vertical_transmission_vector</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">vertical_transmission_vector</span>
            <span class="n">inherit_protection_host</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">inherit_protection_host</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">inherit_protection_host</span>
            <span class="n">inherit_protection_vector</span> <span class="o">=</span> \
                <span class="mi">0</span> <span class="k">if</span> <span class="n">inherit_protection_vector</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">inherit_protection_vector</span>
            <span class="n">protection_upon_recovery_host</span> <span class="o">=</span> <span class="n">protection_upon_recovery_host</span>
            <span class="n">protection_upon_recovery_vector</span> <span class="o">=</span> <span class="n">protection_upon_recovery_vector</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setups</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Setup</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">num_loci</span><span class="p">,</span> <span class="n">possible_alleles</span><span class="p">,</span>
            <span class="n">fitnessHost</span><span class="p">,</span> <span class="n">contactHost</span><span class="p">,</span> <span class="n">receiveContactHost</span><span class="p">,</span> <span class="n">mortalityHost</span><span class="p">,</span>
            <span class="n">natalityHost</span><span class="p">,</span> <span class="n">recoveryHost</span><span class="p">,</span> <span class="n">migrationHost</span><span class="p">,</span>
            <span class="n">populationContactHost</span><span class="p">,</span> <span class="n">receivePopulationContactHost</span><span class="p">,</span>
            <span class="n">mutationHost</span><span class="p">,</span> <span class="n">recombinationHost</span><span class="p">,</span>
            <span class="n">fitnessVector</span><span class="p">,</span> <span class="n">contactVector</span><span class="p">,</span> <span class="n">receiveContactVector</span><span class="p">,</span> <span class="n">mortalityVector</span><span class="p">,</span>
            <span class="n">natalityVector</span><span class="p">,</span><span class="n">recoveryVector</span><span class="p">,</span> <span class="n">migrationVector</span><span class="p">,</span>
            <span class="n">populationContactVector</span><span class="p">,</span> <span class="n">receivePopulationContactVector</span><span class="p">,</span>
            <span class="n">mutationVector</span><span class="p">,</span> <span class="n">recombinationVector</span><span class="p">,</span>
            <span class="n">contact_rate_host_vector</span><span class="p">,</span>
            <span class="n">transmission_efficiency_host_vector</span><span class="p">,</span>
            <span class="n">transmission_efficiency_vector_host</span><span class="p">,</span>
            <span class="n">contact_rate_host_host</span><span class="p">,</span>
            <span class="n">transmission_efficiency_host_host</span><span class="p">,</span>
            <span class="n">mean_inoculum_host</span><span class="p">,</span> <span class="n">mean_inoculum_vector</span><span class="p">,</span>
            <span class="n">recovery_rate_host</span><span class="p">,</span> <span class="n">recovery_rate_vector</span><span class="p">,</span>
            <span class="n">mortality_rate_host</span><span class="p">,</span><span class="n">mortality_rate_vector</span><span class="p">,</span>
            <span class="n">recombine_in_host</span><span class="p">,</span> <span class="n">recombine_in_vector</span><span class="p">,</span>
            <span class="n">num_crossover_host</span><span class="p">,</span> <span class="n">num_crossover_vector</span><span class="p">,</span>
            <span class="n">mutate_in_host</span><span class="p">,</span> <span class="n">mutate_in_vector</span><span class="p">,</span> <span class="n">death_rate_host</span><span class="p">,</span><span class="n">death_rate_vector</span><span class="p">,</span>
            <span class="n">birth_rate_host</span><span class="p">,</span> <span class="n">birth_rate_vector</span><span class="p">,</span>
            <span class="n">vertical_transmission_host</span><span class="p">,</span> <span class="n">vertical_transmission_vector</span><span class="p">,</span>
            <span class="n">inherit_protection_host</span><span class="p">,</span> <span class="n">inherit_protection_vector</span><span class="p">,</span>
            <span class="n">protection_upon_recovery_host</span><span class="p">,</span> <span class="n">protection_upon_recovery_vector</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.newIntervention">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.newIntervention">[docs]</a>
    <span class="k">def</span> <span class="nf">newIntervention</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new intervention to be carried out at a specific time.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            time (number &gt;= 0): time at which intervention will take place.</span>
<span class="sd">            method_name (String): intervention to be carried out, must correspond to the</span>
<span class="sd">                name of a method of the `Model` object.</span>
<span class="sd">            args (array-like): contains arguments for function in positinal order.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Intervention</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span> <span class="p">)</span></div>


<div class="viewcode-block" id="Model.addCustomConditionTracker">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.addCustomConditionTracker">[docs]</a>
    <span class="k">def</span> <span class="nf">addCustomConditionTracker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">condition_id</span><span class="p">,</span> <span class="n">trackerFunction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a function to track occurrences of custom events in simulation.</span>

<span class="sd">        Adds function `trackerFunction` to dictionary `custom_condition_trackers`</span>
<span class="sd">        under key `condition_id`. Function `trackerFunction` will be executed at</span>
<span class="sd">        every event in the simulation. Every time True is returned,</span>
<span class="sd">        the simulation time will be stored under the corresponding `condition_id`</span>
<span class="sd">        key inside `global_trackers[&#39;custom_condition&#39;]`.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            condition_id (String): ID of this specific condition-</span>
<span class="sd">            trackerFunction (callable): function that take a `Model` object as argument </span>
<span class="sd">                and returns True or False.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">custom_condition_trackers</span><span class="p">[</span><span class="s1">&#39;condition_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trackerFunction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_trackers</span><span class="p">[</span><span class="s1">&#39;custom_conditions&#39;</span><span class="p">][</span><span class="s1">&#39;condition_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span></div>


<div class="viewcode-block" id="Model.run">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.run">[docs]</a>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="n">time_sampling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">host_sampling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vector_sampling</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate model for a specified time between two time points.</span>

<span class="sd">        Simulates a time series using the Gillespie algorithm.</span>

<span class="sd">        Saves a dictionary containing model state history, with `keys=times` and</span>
<span class="sd">        `values=Model` objects with model snapshot at that time point under this</span>
<span class="sd">        model&#39;s history attribute.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            t0 (number &gt;= 0): initial time point to start simulation at.</span>
<span class="sd">            tf (number &gt;= 0): initial time point to end simulation at.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            time_sampling (int): how many events to skip before saving a snapshot of the</span>
<span class="sd">                system state (saves all by default), if &lt;0, saves only final state. Defaults to 0.</span>
<span class="sd">            host_sampling (int &gt;= 0): how many hosts to skip before saving one in a snapshot</span>
<span class="sd">                of the system state (saves all by default). Defaults to 0.</span>
<span class="sd">            vector_sampling (int &gt;= 0): how many vectors to skip before saving one in a</span>
<span class="sd">                snapshot of the system state (saves all by default). Defaults to 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sim</span> <span class="o">=</span> <span class="n">Gillespie</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">time_sampling</span><span class="p">,</span> <span class="n">host_sampling</span><span class="p">,</span> <span class="n">vector_sampling</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.runReplicates">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.runReplicates">[docs]</a>
    <span class="k">def</span> <span class="nf">runReplicates</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="n">replicates</span><span class="p">,</span><span class="n">host_sampling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vector_sampling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n_cores</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate replicates of a model, save only end results.</span>

<span class="sd">        Simulates replicates of a time series using the Gillespie algorithm.</span>

<span class="sd">        Saves a dictionary containing model end state state, with `keys=times` and</span>
<span class="sd">        `values=Model` objects with model snapshot. The time is the final timepoint.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            t0 (number &gt;= 0): initial time point to start simulation at.</span>
<span class="sd">            tf (number &gt;= 0): initial time point to end simulation at.</span>
<span class="sd">            replicates (int &gt;= 1): how many replicates to simulate.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            host_sampling (int &gt;= 0): how many hosts to skip before saving one in a snapshot</span>
<span class="sd">                of the system state (saves all by default). Defaults to 0.</span>
<span class="sd">            vector_sampling (int &gt;= 0): how many vectors to skip before saving one in a</span>
<span class="sd">                snapshot of the system state (saves all by default). Defaults to 0.</span>
<span class="sd">            n_cores (int &gt;= 0): number of cores to parallelize file export across, if 0, all</span>
<span class="sd">                cores available are used. Defaults to 0.</span>
<span class="sd">            **kwargs: additional arguents for joblib multiprocessing.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of `Model` objects with the final snapshots.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">n_cores</span><span class="p">:</span>
            <span class="n">n_cores</span> <span class="o">=</span> <span class="n">jl</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting parallel simulations...&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">sim_num</span><span class="p">):</span>
            <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deepCopy</span><span class="p">()</span>
            <span class="n">sim</span> <span class="o">=</span> <span class="n">Gillespie</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">mod</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="n">t0</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="n">time_sampling</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">host_sampling</span><span class="o">=</span><span class="n">host_sampling</span><span class="p">,</span><span class="n">vector_sampling</span><span class="o">=</span><span class="n">vector_sampling</span>
                <span class="p">)[</span><span class="n">tf</span><span class="p">]</span>
            <span class="n">mod</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="p">{</span> <span class="n">tf</span><span class="p">:</span><span class="n">mod</span> <span class="p">}</span>
            <span class="k">return</span> <span class="n">mod</span>

        <span class="k">return</span> <span class="n">jl</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">n_cores</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">(</span>
            <span class="n">jl</span><span class="o">.</span><span class="n">delayed</span><span class="p">(</span> <span class="n">run</span> <span class="p">)</span> <span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">replicates</span><span class="p">)</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.runParamSweep">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.runParamSweep">[docs]</a>
    <span class="k">def</span> <span class="nf">runParamSweep</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="n">setup_id</span><span class="p">,</span>
            <span class="n">param_sweep_dic</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">host_population_size_sweep</span><span class="o">=</span><span class="p">{},</span> <span class="n">vector_population_size_sweep</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">host_migration_sweep_dic</span><span class="o">=</span><span class="p">{},</span> <span class="n">vector_migration_sweep_dic</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">host_host_population_contact_sweep_dic</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">host_vector_population_contact_sweep_dic</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">vector_host_population_contact_sweep_dic</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">replicates</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">host_sampling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vector_sampling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n_cores</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate a parameter sweep with a model, save only end results.</span>

<span class="sd">        Simulates variations of a time series using the Gillespie algorithm.</span>

<span class="sd">        Saves a dictionary containing model end state state, with `keys=times` and</span>
<span class="sd">        `values=Model` objects with model snapshot. The time is the final</span>
<span class="sd">        timepoint.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            t0 (number &gt;= 0): initial time point to start simulation at.</span>
<span class="sd">            tf (number &gt;= 0): initial time point to end simulation at.</span>
<span class="sd">            setup_id (String): ID of setup to be assigned.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            param_sweep_dic -- dictionary with keys=parameter names (attributes of</span>
<span class="sd">                Setup), values=list of values for parameter (list, class of elements</span>
<span class="sd">                depends on parameter)</span>
<span class="sd">            host_population_size_sweep -- dictionary with keys=population IDs</span>
<span class="sd">                (Strings), values=list of values with host population sizes</span>
<span class="sd">                (must be greater than original size set for each population, list of</span>
<span class="sd">                numbers)</span>
<span class="sd">            vector_population_size_sweep -- dictionary with keys=population IDs</span>
<span class="sd">                (Strings), values=list of values with vector population sizes</span>
<span class="sd">                (must be greater than original size set for each population, list of</span>
<span class="sd">                numbers)</span>
<span class="sd">            host_migration_sweep_dic -- dictionary with keys=population IDs of</span>
<span class="sd">                origin and destination, separated by a colon &#39;;&#39; (Strings),</span>
<span class="sd">                values=list of values (list of numbers)</span>
<span class="sd">            vector_migration_sweep_dic -- dictionary with keys=population IDs of</span>
<span class="sd">                origin and destination, separated by a colon &#39;;&#39; (Strings),</span>
<span class="sd">                values=list of values (list of numbers)</span>
<span class="sd">            host_host_population_contact_sweep_dic -- dictionary with</span>
<span class="sd">                keys=population IDs of origin and destination, separated by a colon</span>
<span class="sd">                &#39;;&#39; (Strings), values=list of values (list of numbers)</span>
<span class="sd">            host_vector_population_contact_sweep_dic -- dictionary with</span>
<span class="sd">                keys=population IDs of origin and destination, separated by a colon</span>
<span class="sd">                &#39;;&#39; (Strings), values=list of values (list of numbers)</span>
<span class="sd">            vector_host_population_contact_sweep_dic -- dictionary with</span>
<span class="sd">                keys=population IDs of origin and destination, separated by a colon</span>
<span class="sd">                &#39;;&#39; (Strings), values=list of values (list of numbers)</span>
<span class="sd">            replicates -- how many replicates to simulate (int &gt;= 1)</span>
<span class="sd">            host_sampling -- how many hosts to skip before saving one in a snapshot</span>
<span class="sd">                of the system state (saves all by default) (int &gt;= 0, default 0)</span>
<span class="sd">            vector_sampling -- how many vectors to skip before saving one in a</span>
<span class="sd">                snapshot of the system state (saves all by default)</span>
<span class="sd">                (int &gt;= 0, default 0)</span>
<span class="sd">            n_cores -- number of cores to parallelize file export across, if 0, all</span>
<span class="sd">                cores available are used (default 0; int &gt;= 0)</span>
<span class="sd">            **kwargs -- additional arguents for joblib multiprocessing</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame with parameter combinations, list of Model objects with the</span>
<span class="sd">                final snapshots.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">n_cores</span><span class="p">:</span>
            <span class="n">n_cores</span> <span class="o">=</span> <span class="n">jl</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">host_population_size_sweep</span><span class="p">:</span>
            <span class="n">param_sweep_dic</span><span class="p">[</span><span class="s1">&#39;pop_size_host:&#39;</span><span class="o">+</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">host_population_size_sweep</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">vector_population_size_sweep</span><span class="p">:</span>
            <span class="n">param_sweep_dic</span><span class="p">[</span><span class="s1">&#39;pop_size_vector:&#39;</span><span class="o">+</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">vector_population_size_sweep</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">host_migration_sweep_dic</span><span class="p">:</span>
            <span class="n">param_sweep_dic</span><span class="p">[</span><span class="s1">&#39;migrate_host:&#39;</span><span class="o">+</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">host_migration_sweep_dic</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">vector_migration_sweep_dic</span><span class="p">:</span>
            <span class="n">param_sweep_dic</span><span class="p">[</span><span class="s1">&#39;migrate_vector:&#39;</span><span class="o">+</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">vector_migration_sweep_dic</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">host_host_population_contact_sweep_dic</span><span class="p">:</span>
            <span class="n">param_sweep_dic</span><span class="p">[</span><span class="s1">&#39;population_contact_host_host:&#39;</span><span class="o">+</span><span class="n">p</span><span class="p">]</span> \
                <span class="o">=</span> <span class="n">host_host_population_contact_sweep_dic</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">host_vector_population_contact_sweep_dic</span><span class="p">:</span>
            <span class="n">param_sweep_dic</span><span class="p">[</span><span class="s1">&#39;population_contact_host_vector:&#39;</span><span class="o">+</span><span class="n">p</span><span class="p">]</span> \
                <span class="o">=</span> <span class="n">host_vector_population_contact_sweep_dic</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">vector_host_population_contact_sweep_dic</span><span class="p">:</span>
            <span class="n">param_sweep_dic</span><span class="p">[</span><span class="s1">&#39;population_contact_vector_host:&#39;</span><span class="o">+</span><span class="n">p</span><span class="p">]</span> \
                <span class="o">=</span> <span class="n">vector_host_population_contact_sweep_dic</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_sweep_dic</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;param_sweep_dic, host_migration_sweep_dic, vector_migration_sweep_dic, host_host_population_contact_sweep_dic, host_vector_population_contact_sweep_dic, and vector_host_population_contact_sweep_dic cannot all be empty in runParamSweep()&#39;</span>
                <span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="n">param_sweep_dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">value_lists</span> <span class="o">=</span> <span class="p">[</span> <span class="n">param_sweep_dic</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span> <span class="p">]</span>
        <span class="n">combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="n">it</span><span class="o">.</span><span class="n">product</span><span class="p">(</span> <span class="o">*</span><span class="n">value_lists</span> <span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="n">replicates</span>

        <span class="n">param_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">combinations</span><span class="p">)</span>
        <span class="n">param_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">params</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting parallel simulations...&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">param_values</span><span class="p">):</span>
            <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deepCopy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">param_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
                <span class="k">if</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">param_name</span><span class="p">:</span>
                    <span class="n">pops</span> <span class="o">=</span> <span class="n">param_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s1">&#39;pop_size_host:&#39;</span> <span class="ow">in</span> <span class="n">param_name</span><span class="p">:</span>
                        <span class="n">pop</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">)</span>
                        <span class="n">add_hosts</span> <span class="o">=</span> <span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">hosts</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">add_hosts</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                <span class="s1">&#39;Value &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; assigned to &#39;</span> <span class="o">+</span> <span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; in host_population_size_sweep must be greater or equal to the population</span><span class="se">\&#39;</span><span class="s1">s original number of hosts.&#39;</span>
                                <span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">pop</span><span class="o">.</span><span class="n">addHosts</span><span class="p">(</span><span class="n">add_hosts</span><span class="p">)</span>
                            <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pop</span>
                            <span class="n">pop</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

                    <span class="k">elif</span> <span class="s1">&#39;pop_size_vector:&#39;</span> <span class="ow">in</span> <span class="n">param_name</span><span class="p">:</span>
                        <span class="n">pop</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">)</span>
                        <span class="n">add_vectors</span> <span class="o">=</span> <span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">vectors</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">add_vectors</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                <span class="s1">&#39;Values &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; assigned to &#39;</span> <span class="o">+</span> <span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; in vector_population_size_sweep must be greater or equal to the population</span><span class="se">\&#39;</span><span class="s1">s original number of vectors.&#39;</span>
                                <span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">pop</span><span class="o">.</span><span class="n">addVectors</span><span class="p">(</span><span class="n">add_vectors</span><span class="p">)</span>
                            <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pop</span>
                            <span class="n">pop</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

                    <span class="k">elif</span> <span class="s1">&#39;migrate_host:&#39;</span> <span class="ow">in</span> <span class="n">param_name</span><span class="p">:</span>
                        <span class="n">new_pops</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">),</span>
                            <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="p">)</span>
                            <span class="p">]</span>
                        <span class="n">new_pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
                        <span class="n">new_pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">linkPopulationsHostMigration</span><span class="p">(</span>
                            <span class="n">new_pops</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">new_pops</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="p">)</span>
                    <span class="k">elif</span> <span class="s1">&#39;migrate_vector:&#39;</span> <span class="ow">in</span> <span class="n">param_name</span><span class="p">:</span>
                        <span class="n">new_pops</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">),</span>
                            <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="p">)</span>
                            <span class="p">]</span>
                        <span class="n">new_pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
                        <span class="n">new_pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">linkPopulationsVectorMigration</span><span class="p">(</span>
                            <span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="p">)</span>
                    <span class="k">elif</span> <span class="s1">&#39;population_contact_host_host:&#39;</span> <span class="ow">in</span> <span class="n">param_name</span><span class="p">:</span>
                        <span class="n">new_pops</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">),</span>
                            <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="p">)</span>
                            <span class="p">]</span>
                        <span class="n">new_pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
                        <span class="n">new_pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">linkPopulationsHostHostContact</span><span class="p">(</span>
                            <span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="p">)</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">linkPopulationsHostHostContact</span><span class="p">(</span>
                            <span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="p">)</span>
                    <span class="k">elif</span> <span class="s1">&#39;population_contact_host_vector:&#39;</span> <span class="ow">in</span> <span class="n">param_name</span><span class="p">:</span>
                        <span class="n">new_pops</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">),</span>
                            <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="p">)</span>
                            <span class="p">]</span>
                        <span class="n">new_pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
                        <span class="n">new_pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">linkPopulationsHostVectorContact</span><span class="p">(</span>
                            <span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="p">)</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">linkPopulationsHostVectorContact</span><span class="p">(</span>
                            <span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="p">)</span>
                    <span class="k">elif</span> <span class="s1">&#39;population_contact_vector_host:&#39;</span> <span class="ow">in</span> <span class="n">param_name</span><span class="p">:</span>
                        <span class="n">new_pops</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">),</span>
                            <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="p">)</span>
                            <span class="p">]</span>
                        <span class="n">new_pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
                        <span class="n">new_pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_pops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">linkPopulationsVectorHostContact</span><span class="p">(</span>
                            <span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="p">)</span>
                        <span class="n">model</span><span class="o">.</span><span class="n">linkPopulationsVectorHostContact</span><span class="p">(</span>
                            <span class="n">pops</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">setups</span><span class="p">[</span><span class="n">setup_id</span><span class="p">],</span><span class="n">param_name</span><span class="p">,</span><span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">pop</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">setSetup</span><span class="p">(</span> <span class="n">model</span><span class="o">.</span><span class="n">setups</span><span class="p">[</span><span class="n">pop</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="p">)</span>

            <span class="n">sim</span> <span class="o">=</span> <span class="n">Gillespie</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">mod</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="n">t0</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="n">time_sampling</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">host_sampling</span><span class="o">=</span><span class="n">host_sampling</span><span class="p">,</span><span class="n">vector_sampling</span><span class="o">=</span><span class="n">vector_sampling</span>
                <span class="p">)[</span><span class="n">tf</span><span class="p">]</span>
            <span class="n">mod</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="p">{</span> <span class="n">tf</span><span class="p">:</span><span class="n">mod</span> <span class="p">}</span>
            <span class="k">return</span> <span class="n">mod</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">param_df</span><span class="p">,</span>
            <span class="n">jl</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">n_cores</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">(</span>
                <span class="n">jl</span><span class="o">.</span><span class="n">delayed</span><span class="p">(</span> <span class="n">run</span> <span class="p">)</span> <span class="p">(</span><span class="n">param_values</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">param_values</span> <span class="ow">in</span> <span class="n">combinations</span>
                <span class="p">)</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.copyState">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.copyState">[docs]</a>
    <span class="k">def</span> <span class="nf">copyState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">host_sampling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vector_sampling</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a slimmed-down representation of the current model state.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            host_sampling (int &gt;= 0): how many hosts to skip before saving one in a snapshot</span>
<span class="sd">                of the system state (saves all by default). Defaults to 0.</span>
<span class="sd">            vector_sampling (int &gt;= 0): how many vectors to skip before saving one in a</span>
<span class="sd">                snapshot of the system state (saves all by default). Defaults to 0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Model object with current population host and vector lists.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">copy</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>

        <span class="n">copy</span><span class="o">.</span><span class="n">populations</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nb">id</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">copyState</span><span class="p">(</span><span class="n">host_sampling</span><span class="p">,</span><span class="n">vector_sampling</span><span class="p">)</span>
            <span class="k">for</span> <span class="nb">id</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>

        <span class="k">return</span> <span class="n">copy</span></div>


<div class="viewcode-block" id="Model.deepCopy">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.deepCopy">[docs]</a>
    <span class="k">def</span> <span class="nf">deepCopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a full copy of the current model with inner references.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Copied Model object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">intervention</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">interventions</span><span class="p">:</span>
            <span class="n">intervention</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
            <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">.</span><span class="n">hosts</span><span class="p">:</span>
                <span class="n">h</span><span class="o">.</span><span class="n">population</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">.</span><span class="n">vectors</span><span class="p">:</span>
                <span class="n">v</span><span class="o">.</span><span class="n">population</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">model</span></div>



    <span class="c1">### Output and Plots: ###</span>

<div class="viewcode-block" id="Model.saveToDataFrame">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.saveToDataFrame">[docs]</a>
    <span class="k">def</span> <span class="nf">saveToDataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">save_to_file</span><span class="p">,</span><span class="n">n_cores</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save status of model to dataframe, write to file location given.</span>

<span class="sd">        Creates a pandas Dataframe in long format with the given model history,</span>
<span class="sd">        with one host or vector per simulation time in each row, and columns:</span>
<span class="sd">            </span>
<span class="sd">        - Time - simulation time of entry</span>
<span class="sd">        - Population - ID of this host/vector&#39;s population</span>
<span class="sd">        - Organism - host/vector</span>
<span class="sd">        - ID - ID of host/vector</span>
<span class="sd">        - Pathogens - all genomes present in this host/vector separated by &#39;;&#39;</span>
<span class="sd">        - Protection - all genomes present in this host/vector separated by &#39;;&#39;</span>
<span class="sd">        - Alive - whether host/vector is alive at this time, True/False</span>

<span class="sd">        Arguments:</span>
<span class="sd">            save_to_file (String): file path and name to save model data under.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            n_cores (int &gt;= 0): number of cores to parallelize file export across, if 0, all</span>
<span class="sd">                cores available are used. Defaults to 0.</span>
<span class="sd">            **kwargs: additional arguents for joblib multiprocessing.</span>

<span class="sd">        Returns:</span>
<span class="sd">            `pandas dataframe` with model history as described above.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">saveToDf</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">,</span><span class="n">save_to_file</span><span class="p">,</span><span class="n">n_cores</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="Model.getPathogens">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.getPathogens">[docs]</a>
    <span class="k">def</span> <span class="nf">getPathogens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">save_to_file</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create Dataframe with counts for all pathogen genomes in data.</span>

<span class="sd">        Returns sorted pandas Dataframe with counts for occurrences of all</span>
<span class="sd">        pathogen genomes in data passed.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            data (pandas DataFrame): dataframe with model history as produced by `saveToDf` function.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            save_to_file (String): file path and name to save model data under, no saving</span>
<span class="sd">                occurs if empty string. Defaults to &quot;&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            `pandas dataframe` with Series as described above.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">getPathogens</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">save_to_file</span><span class="o">=</span><span class="n">save_to_file</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.getProtections">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.getProtections">[docs]</a>
    <span class="k">def</span> <span class="nf">getProtections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">save_to_file</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create Dataframe with counts for all protection sequences in data.</span>

<span class="sd">        Returns sorted `pandas Dataframe` with counts for occurrences of all</span>
<span class="sd">        protection sequences in data passed.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            data (pandas DataFrame): dataframe with model history as produced by `saveToDf` function.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            save_to_file (String): file path and name to save model data under, no saving</span>
<span class="sd">                occurs if empty string. Defaults to &quot;&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas DataFrame with Series as described above.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">getProtections</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">save_to_file</span><span class="o">=</span><span class="n">save_to_file</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.populationsPlot">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.populationsPlot">[docs]</a>
    <span class="k">def</span> <span class="nf">populationsPlot</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">compartment</span><span class="o">=</span><span class="s1">&#39;Infected&#39;</span><span class="p">,</span>
            <span class="n">hosts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_top_populations</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
            <span class="n">track_specific_populations</span><span class="o">=</span><span class="p">[],</span> <span class="n">save_data_to_file</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Hosts&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
            <span class="n">palette</span><span class="o">=</span><span class="n">CB_PALETTE</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create plot with aggregated totals per population across time.</span>

<span class="sd">        Creates a line or stacked line plot with dynamics of a compartment</span>
<span class="sd">        across populations in the model, with one line for each population.</span>

<span class="sd">        A host or vector is considered part of the recovered compartment</span>
<span class="sd">        if it has protection sequences of any kind and is not infected.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            file_name (String): file path, name, and extension to save plot under.</span>
<span class="sd">            data (pandas DataFrame): dataframe with model history as produced by saveToDf function.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            compartment (String): subset of hosts/vectors to count totals of, can be either</span>
<span class="sd">                &#39;Naive&#39;,&#39;Infected&#39;,&#39;Recovered&#39;, or &#39;Dead&#39;. Defaults to &#39;Infected&#39;.</span>
<span class="sd">            hosts (Boolean): whether to count hosts. Defaults to True.</span>
<span class="sd">            vectors (Boolean) whether to count vectors. Defaults to False.</span>
<span class="sd">            num_top_populations (int): how many populations to count separately and</span>
<span class="sd">                include as columns, remainder will be counted under column &quot;Other&quot;;</span>
<span class="sd">                if &lt;0, includes all populations in model. Defaults to 7.</span>
<span class="sd">            track_specific_populations (list of Strings): contains IDs of specific populations to</span>
<span class="sd">                have as a separate column if not part of the top num_top_populations</span>
<span class="sd">                populations. Defaults to [].</span>
<span class="sd">            save_data_to_file (String): file path and name to save model plot data under,</span>
<span class="sd">                no saving occurs if empty string. Defaults to &quot;&quot;.</span>
<span class="sd">            x_label (String): X axis title. Defaults to &#39;Time&#39;.</span>
<span class="sd">            y_label (String): Y axis title. Defaults to &#39;Hosts&#39;.</span>
<span class="sd">            legend_title (String): legend title. Defaults to &#39;Population&#39;.</span>
<span class="sd">            legend_values (list of Strings): labels for each trace, if empty list, uses population</span>
<span class="sd">                IDs. Defaults to [].</span>
<span class="sd">            figsize (array-like of two ints): dimensions of figure. Defaults to (8,4).</span>
<span class="sd">            dpi (int): figure resolution. Defaults to 200.</span>
<span class="sd">            palette (list of color Strings): color palette to use for traces. Defaults to `CB_PALETTE`.</span>
<span class="sd">            stacked (Boolean): whether to draw a regular line plot instead of a stacked one. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            `axis object` for plot with model population dynamics as described above.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">populationsPlot</span><span class="p">(</span>
            <span class="n">file_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">compartment</span><span class="o">=</span><span class="n">compartment</span><span class="p">,</span> <span class="n">hosts</span><span class="o">=</span><span class="n">hosts</span><span class="p">,</span>
            <span class="n">vectors</span><span class="o">=</span><span class="n">vectors</span><span class="p">,</span> <span class="n">num_top_populations</span><span class="o">=</span><span class="n">num_top_populations</span><span class="p">,</span>
            <span class="n">track_specific_populations</span><span class="o">=</span><span class="n">track_specific_populations</span><span class="p">,</span>
            <span class="n">save_data_to_file</span><span class="o">=</span><span class="n">save_data_to_file</span><span class="p">,</span>
            <span class="n">x_label</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
            <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="n">stacked</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.compartmentPlot">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.compartmentPlot">[docs]</a>
    <span class="k">def</span> <span class="nf">compartmentPlot</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">populations</span><span class="o">=</span><span class="p">[],</span> <span class="n">hosts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">save_data_to_file</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Hosts&#39;</span><span class="p">,</span>
            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">CB_PALETTE</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create plot with number of naive,inf,rec,dead hosts/vectors vs. time.</span>

<span class="sd">        Creates a line or stacked line plot with dynamics of all compartments</span>
<span class="sd">        (naive, infected, recovered, dead) across selected populations in the</span>
<span class="sd">        model, with one line for each compartment.</span>

<span class="sd">        A host or vector is considered part of the recovered compartment</span>
<span class="sd">        if it has protection sequences of any kind and is not infected.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            file_name (String): file path, name, and extension to save plot under.</span>
<span class="sd">            data (pandas DataFrame): dataframe with model history as produced by `saveToDf` function.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            populations (list of Strings): IDs of populations to include in analysis; if empty, uses</span>
<span class="sd">                all populations in model. Defaults to [].</span>
<span class="sd">            hosts (Boolean): whether to count hosts. Defaults to True.</span>
<span class="sd">            vectors (Boolean): whether to count vectors. Defaults to False.</span>
<span class="sd">            save_data_to_file (String): file path and name to save model data under, no</span>
<span class="sd">                saving occurs if empty string. Defaults to &quot;&quot;.</span>
<span class="sd">            x_label (String): X axis title. Defaults to &#39;Time&#39;.</span>
<span class="sd">            y_label (String): Y axis title. Defaults to &#39;Hosts&#39;.</span>
<span class="sd">            legend_title (String): legend title. Defaults to &#39;Population&#39;.</span>
<span class="sd">            legend_values (list of Strings): labels for each trace, if empty list, uses population</span>
<span class="sd">                IDs. Defaults to [].</span>
<span class="sd">            figsize (array-like of two ints): dimensions of figure. Defaults to (8,4).</span>
<span class="sd">            dpi (int)): figure resolution. Defaults to 200.</span>
<span class="sd">            palette (list of color Strings): color palette to use for traces. Defaults to `CB_PALETTE`.</span>
<span class="sd">            stacked -- whether to draw a regular line plot instead of a stacked one</span>
<span class="sd">                (default False, Boolean)</span>

<span class="sd">        Returns:</span>
<span class="sd">            axis object for plot with model compartment dynamics as described above</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">compartmentPlot</span><span class="p">(</span>
            <span class="n">file_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">populations</span><span class="o">=</span><span class="n">populations</span><span class="p">,</span> <span class="n">hosts</span><span class="o">=</span><span class="n">hosts</span><span class="p">,</span>
            <span class="n">vectors</span><span class="o">=</span><span class="n">vectors</span><span class="p">,</span> <span class="n">save_data_to_file</span><span class="o">=</span><span class="n">save_data_to_file</span><span class="p">,</span>
            <span class="n">x_label</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
            <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="n">stacked</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.compositionPlot">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.compositionPlot">[docs]</a>
    <span class="k">def</span> <span class="nf">compositionPlot</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">composition_dataframe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">populations</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">type_of_composition</span><span class="o">=</span><span class="s1">&#39;Pathogens&#39;</span><span class="p">,</span> <span class="n">hosts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">num_top_sequences</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">track_specific_sequences</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">save_data_to_file</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Infections&#39;</span><span class="p">,</span>
            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">CB_PALETTE</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">remove_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">genomic_positions</span><span class="o">=</span><span class="p">[],</span><span class="n">population_fraction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">count_individuals_based_on_model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">legend_title</span><span class="o">=</span><span class="s1">&#39;Genotype&#39;</span><span class="p">,</span> <span class="n">legend_values</span><span class="o">=</span><span class="p">[],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create plot with counts for pathogen genomes or resistance vs. time.</span>

<span class="sd">        Creates a line or stacked line plot with dynamics of the pathogen</span>
<span class="sd">        strains or protection sequences across selected populations in the</span>
<span class="sd">        model, with one line for each pathogen genome or protection sequence</span>
<span class="sd">        being shown.</span>

<span class="sd">        Of note: sum of totals for all sequences in one time point does not</span>
<span class="sd">        necessarily equal the number of infected hosts and/or vectors, given</span>
<span class="sd">        multiple infections in the same host/vector are counted separately.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            file_name (String): file path, name, and extension to save plot under.</span>
<span class="sd">            data (pandas DataFrame): dataframe with model history as produced by `saveToDf` function.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            composition_dataframe (pandas DataFrame): output of compositionDf() if already computed</span>
<span class="sd">                Defaults to None.</span>
<span class="sd">            populations (list of Strings): IDs of populations to include in analysis; if empty, uses</span>
<span class="sd">                all populations in model. Defaults to [].</span>
<span class="sd">            type_of_composition (String) field of data to count totals of, can be either</span>
<span class="sd">                &#39;Pathogens&#39; or &#39;Protection&#39;. Defaults to &#39;Pathogens&#39;.</span>
<span class="sd">            hosts (Boolean) whether to count hosts. Defaults to True.</span>
<span class="sd">            vectors (Boolean): whether to count vectors. Defaults to False.</span>
<span class="sd">            num_top_sequences (int): how many sequences to count separately and include</span>
<span class="sd">                as columns, remainder will be counted under column &quot;Other&quot;; if &lt;0,</span>
<span class="sd">                includes all genomes in model. Defaults to 7.</span>
<span class="sd">            track_specific_sequences (list of Strings): contains specific sequences to have</span>
<span class="sd">                as a separate column if not part of the top num_top_sequences</span>
<span class="sd">                sequences. Defaults to [].</span>
<span class="sd">            genomic_positions (list of lists of int): list in which each element is a list with loci</span>
<span class="sd">                positions to extract (e.g. genomic_positions=[ [0,3], [5,6] ]</span>
<span class="sd">                extracts positions 0, 1, 2, and 5 from each genome); if empty, takes</span>
<span class="sd">                full genomes. Defaults to [].</span>
<span class="sd">            count_individuals_based_on_model (None or Model): `Model` object with populations and</span>
<span class="sd">                fitness functions used to evaluate the most fit pathogen genome in</span>
<span class="sd">                each host/vector in order to count only a single pathogen per</span>
<span class="sd">                host/vector, as opposed to all pathogens within each host/vector; if</span>
<span class="sd">                None, counts all pathogens. Defaults to None.</span>
<span class="sd">            save_data_to_file (String): file path and name to save model data under, no</span>
<span class="sd">                saving occurs if empty string. Defaults to &quot;&quot;.</span>
<span class="sd">            x_label (String): X axis title. Defaults to &#39;Time&#39;.</span>
<span class="sd">            y_label (String): Y axis title. Defaults to &#39;Hosts&#39;.</span>
<span class="sd">            legend_title (String): legend title. Defaults to &#39;Population&#39;.</span>
<span class="sd">            legend_values (list of Strings): labels for each trace, if empty list, uses population</span>
<span class="sd">                IDs. Defaults to [].</span>
<span class="sd">            figsize (array-like of two ints): dimensions of figure. Defaults to (8,4).</span>
<span class="sd">            dpi (int): figure resolution. Defaults to 200.</span>
<span class="sd">            palette (list of color Strings): color palette to use for traces. Defaults to `CB_PALETTE`.</span>
<span class="sd">            stacked (Boolean): whether to draw a regular line plot instead of a stacked one. Defaults to False.</span>
<span class="sd">            remove_legend (Boolean): whether to print the sequences on the figure legend</span>
<span class="sd">                instead of printing them on a separate csv file. Defaults to True.</span>
<span class="sd">            **kwargs: additional arguents for joblib multiprocessing.</span>

<span class="sd">        Returns:</span>
<span class="sd">            axis object for plot with model sequence composition dynamics as described.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">compositionPlot</span><span class="p">(</span>
            <span class="n">file_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
            <span class="n">composition_dataframe</span><span class="o">=</span><span class="n">composition_dataframe</span><span class="p">,</span><span class="n">populations</span><span class="o">=</span><span class="n">populations</span><span class="p">,</span>
            <span class="n">type_of_composition</span><span class="o">=</span><span class="n">type_of_composition</span><span class="p">,</span> <span class="n">hosts</span><span class="o">=</span><span class="n">hosts</span><span class="p">,</span>
            <span class="n">vectors</span><span class="o">=</span><span class="n">vectors</span><span class="p">,</span> <span class="n">num_top_sequences</span><span class="o">=</span><span class="n">num_top_sequences</span><span class="p">,</span>
            <span class="n">track_specific_sequences</span><span class="o">=</span><span class="n">track_specific_sequences</span><span class="p">,</span>
            <span class="n">save_data_to_file</span><span class="o">=</span><span class="n">save_data_to_file</span><span class="p">,</span>
            <span class="n">x_label</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
            <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="n">stacked</span><span class="p">,</span> <span class="n">remove_legend</span><span class="o">=</span><span class="n">remove_legend</span><span class="p">,</span>
            <span class="n">genomic_positions</span><span class="o">=</span><span class="n">genomic_positions</span><span class="p">,</span>
            <span class="n">count_individuals_based_on_model</span><span class="o">=</span><span class="n">count_individuals_based_on_model</span><span class="p">,</span>
            <span class="n">population_fraction</span><span class="o">=</span><span class="n">population_fraction</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span>
            <span class="n">legend_values</span><span class="o">=</span><span class="n">legend_values</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.clustermap">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.clustermap">[docs]</a>
    <span class="k">def</span> <span class="nf">clustermap</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">file_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">num_top_sequences</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">track_specific_sequences</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">seq_names</span><span class="o">=</span><span class="p">[],</span> <span class="n">n_cores</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">,</span>
            <span class="n">save_data_to_file</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">legend_title</span><span class="o">=</span><span class="s1">&#39;Distance&#39;</span><span class="p">,</span> <span class="n">legend_values</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="n">DEF_CMAP</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a heatmap and dendrogram for pathogen genomes in data passed.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            file_name (String): file path, name, and extension to save plot under.</span>
<span class="sd">            data (pandas DataFrame): dataframe with model history as produced by `saveToDf` </span>
<span class="sd">                function.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            num_top_sequences (int): how many sequences to include in matrix; if &lt;0,</span>
<span class="sd">                includes all genomes in data passed. Defaults to -1.</span>
<span class="sd">            track_specific_sequences (list of Strings): contains specific sequences to include </span>
<span class="sd">                in matrix if not part of the top num_top_sequences sequences. Defaults to [].</span>
<span class="sd">            seq_names (list ofStrings): list with names to be used for sequence labels in matrix</span>
<span class="sd">                must be of same length as number of sequences to be displayed; if empty, uses sequences </span>
<span class="sd">                themselves. Defaults to [].</span>
<span class="sd">            n_cores (int &gt;= 0): number of cores to parallelize distance compute across, if 0,</span>
<span class="sd">                all cores available are used. Defaults to 0.</span>
<span class="sd">            method (String): clustering algorithm to use with seaborn clustermap. Defaults to &#39;weighted&#39;.</span>
<span class="sd">            metric (String): distance metric to use with seaborn clustermap. Defaults to &#39;euclidean&#39;.</span>
<span class="sd">            save_data_to_file (String): file path and name to save model data under, no</span>
<span class="sd">                saving occurs if empty string. Defaults to &quot;&quot;.</span>
<span class="sd">            legend_title (String): legend title. Defaults to &#39;Distance&#39;.</span>
<span class="sd">            figsize (array-like of two ints): dimensions of figure. Defaults to (8,4).</span>
<span class="sd">            dpi (int): figure resolution. Defaults to 200.</span>
<span class="sd">            color_map (matplotlib cmap object): color map to use for traces. Defaults to `DEF_CMAP`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            figure object for plot with heatmap and dendrogram as described.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">clustermap</span><span class="p">(</span>
                <span class="n">file_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">num_top_sequences</span><span class="o">=</span><span class="n">num_top_sequences</span><span class="p">,</span>
                <span class="n">track_specific_sequences</span><span class="o">=</span><span class="n">track_specific_sequences</span><span class="p">,</span>
                <span class="n">seq_names</span><span class="o">=</span><span class="n">seq_names</span><span class="p">,</span> <span class="n">n_cores</span><span class="o">=</span><span class="n">n_cores</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span> <span class="n">save_data_to_file</span><span class="o">=</span><span class="n">save_data_to_file</span><span class="p">,</span>
                <span class="n">legend_title</span><span class="o">=</span><span class="n">legend_title</span><span class="p">,</span> <span class="n">legend_values</span><span class="o">=</span><span class="n">legend_values</span><span class="p">,</span>
                <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="n">color_map</span>
                <span class="p">)</span></div>


<div class="viewcode-block" id="Model.pathogenDistanceHistory">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.pathogenDistanceHistory">[docs]</a>
    <span class="k">def</span> <span class="nf">pathogenDistanceHistory</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">samples</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_top_sequences</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">track_specific_sequences</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">seq_names</span><span class="o">=</span><span class="p">[],</span> <span class="n">n_cores</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">save_to_file</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create DataFrame with pairwise Hamming distances for pathogen</span>
<span class="sd">        sequences in data.</span>

<span class="sd">        DataFrame has indexes and columns named according to genomes or argument</span>
<span class="sd">        seq_names, if passed. Distance is measured as percent Hamming distance</span>
<span class="sd">        from an optimal genome sequence.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            data (pandas DataFrame): dataframe with model history as produced by `saveToDf` </span>
<span class="sd">                function.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            samples (int): how many timepoints to uniformly sample from the total</span>
<span class="sd">                timecourse; if &lt;0, takes all timepoints. Defaults to 1.</span>
<span class="sd">            num_top_sequences (int) how many sequences to include in matrix; if &lt;0,</span>
<span class="sd">                includes all genomes in data passed. Defaults to -1.</span>
<span class="sd">            track_specific_sequences (list of Strings): contains specific sequences to include in</span>
<span class="sd">                matrix if not part of the top num_top_sequences sequences. Defaults to [].</span>
<span class="sd">            seq_names (list of Strings): list with names to be used for sequence labels in matrix</span>
<span class="sd">                must be of same length as number of sequences to be displayed; if</span>
<span class="sd">                empty, uses sequences themselves. Defaults to [].</span>
<span class="sd">            n_cores (int &gt;= 0): number of cores to parallelize distance compute across, if 0,</span>
<span class="sd">                all cores available are used. Defaults to 0.</span>
<span class="sd">            save_to_file (String): file path and name to save model data under, no saving</span>
<span class="sd">                occurs if empty string. Defaults to &quot;&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas DataFrame with distance matrix as described above.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">getPathogenDistanceHistoryDf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
            <span class="n">samples</span><span class="o">=</span><span class="n">samples</span><span class="p">,</span> <span class="n">num_top_sequences</span><span class="o">=</span><span class="n">num_top_sequences</span><span class="p">,</span>
            <span class="n">track_specific_sequences</span><span class="o">=</span><span class="n">track_specific_sequences</span><span class="p">,</span>
            <span class="n">seq_names</span><span class="o">=</span><span class="n">seq_names</span><span class="p">,</span> <span class="n">n_cores</span><span class="o">=</span><span class="n">n_cores</span><span class="p">,</span> <span class="n">save_to_file</span><span class="o">=</span><span class="n">save_to_file</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.getGenomeTimes">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.getGenomeTimes">[docs]</a>
    <span class="k">def</span> <span class="nf">getGenomeTimes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">samples</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_top_sequences</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">track_specific_sequences</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">seq_names</span><span class="o">=</span><span class="p">[],</span> <span class="n">n_cores</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">save_to_file</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create DataFrame with times genomes first appeared during simulation.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            data (pandas DataFrame): dataframe with model history as produced by `saveToDf` </span>
<span class="sd">                function.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            samples (int): how many timepoints to uniformly sample from the total</span>
<span class="sd">                timecourse; if &lt;0, takes all timepoints. Defaults to 1.</span>
<span class="sd">            save_to_file (String): file path and name to save model data under, no saving</span>
<span class="sd">                occurs if empty string. Defaults to &quot;&quot;.</span>
<span class="sd">            n_cores (int): number of cores to parallelize across, if 0, all cores</span>
<span class="sd">                available are used. Defaults to 0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas DataFrame with genomes and times as described above.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">getGenomeTimesDf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
            <span class="n">samples</span><span class="o">=</span><span class="n">samples</span><span class="p">,</span> <span class="n">num_top_sequences</span><span class="o">=</span><span class="n">num_top_sequences</span><span class="p">,</span>
            <span class="n">track_specific_sequences</span><span class="o">=</span><span class="n">track_specific_sequences</span><span class="p">,</span>
            <span class="n">seq_names</span><span class="o">=</span><span class="n">seq_names</span><span class="p">,</span> <span class="n">n_cores</span><span class="o">=</span><span class="n">n_cores</span><span class="p">,</span> <span class="n">save_to_file</span><span class="o">=</span><span class="n">save_to_file</span><span class="p">)</span></div>



<div class="viewcode-block" id="Model.getCompositionData">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.getCompositionData">[docs]</a>
    <span class="k">def</span> <span class="nf">getCompositionData</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">populations</span><span class="o">=</span><span class="p">[],</span> <span class="n">type_of_composition</span><span class="o">=</span><span class="s1">&#39;Pathogens&#39;</span><span class="p">,</span>
            <span class="n">hosts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_top_sequences</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">track_specific_sequences</span><span class="o">=</span><span class="p">[],</span> <span class="n">genomic_positions</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">count_individuals_based_on_model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_data_to_file</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">n_cores</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create dataframe with counts for pathogen genomes or resistance.</span>

<span class="sd">        Creates a pandas Dataframe with dynamics of the pathogen strains or</span>
<span class="sd">        protection sequences across selected populations in the model,</span>
<span class="sd">        with one time point in each row and columns for pathogen genomes or</span>
<span class="sd">        protection sequences.</span>

<span class="sd">        Of note: sum of totals for all sequences in one time point does not</span>
<span class="sd">        necessarily equal the number of infected hosts and/or vectors, given</span>
<span class="sd">        multiple infections in the same host/vector are counted separately.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            data (pandas DataFrame): dataframe with model history as produced by `saveToDf` </span>
<span class="sd">                function; if None, computes this dataframe and saves it under &#39;raw_data_&#39;+&#39;save_data_to_file&#39;. </span>
<span class="sd">                Defaults to None.</span>
<span class="sd">            populations (list of Strings): IDs of populations to include in analysis; if empty, uses</span>
<span class="sd">                all populations in model. Defaults to [].</span>
<span class="sd">            type_of_composition (String): field of data to count totals of, can be either</span>
<span class="sd">                &#39;Pathogens&#39; or &#39;Protection&#39;. Defaults to &#39;Pathogens&#39;.</span>
<span class="sd">            hosts (Boolean): whether to count hosts. Defaults to True.</span>
<span class="sd">            vectors (Boolean): whether to count vectors. Defaults to False.</span>
<span class="sd">            num_top_sequences (int): how many sequences to count separately and include</span>
<span class="sd">                as columns, remainder will be counted under column &quot;Other&quot;; if &lt;0,</span>
<span class="sd">                includes all genomes in model. Defaults to -1.</span>
<span class="sd">            track_specific_sequences (list of Strings): contains specific sequences to have</span>
<span class="sd">                as a separate column if not part of the top num_top_sequences</span>
<span class="sd">                sequences. Defaults to [].</span>
<span class="sd">            genomic_positions (list of lists of int): list in which each element is a list with </span>
<span class="sd">                loci positions to extract (e.g. genomic_positions=[ [0,3], [5,6] ]</span>
<span class="sd">                extracts positions 0, 1, 2, and 5 from each genome); if empty, takes</span>
<span class="sd">                full genomes. Defaults to [].</span>
<span class="sd">            count_individuals_based_on_model (None or Model object): Model object with populations and</span>
<span class="sd">                fitness functions used to evaluate the most fit pathogen genome in</span>
<span class="sd">                each host/vector in order to count only a single pathogen per</span>
<span class="sd">                host/vector, asopposed to all pathogens within each host/vector; if</span>
<span class="sd">                None, counts all pathogens. Defaults to None.</span>
<span class="sd">            save_data_to_file (String): file path and name to save model data under, no</span>
<span class="sd">                saving occurs if empty string. Defaults to &quot;&quot;.</span>
<span class="sd">            n_cores (int): number of cores to parallelize processing across, if 0, all</span>
<span class="sd">                cores available are used. Defaults to 0.</span>
<span class="sd">            **kwargs: additional arguents for joblib multiprocessing.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas DataFrame with model sequence composition dynamics as described</span>
<span class="sd">                above.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">saveToDf</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">,</span><span class="s1">&#39;raw_data_&#39;</span><span class="o">+</span><span class="n">save_to_file</span><span class="p">,</span><span class="n">n_cores</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">compositionDf</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">populations</span><span class="o">=</span><span class="n">populations</span><span class="p">,</span>
            <span class="n">type_of_composition</span><span class="o">=</span><span class="n">type_of_composition</span><span class="p">,</span>
            <span class="n">hosts</span><span class="o">=</span><span class="n">hosts</span><span class="p">,</span> <span class="n">vectors</span><span class="o">=</span><span class="n">vectors</span><span class="p">,</span> <span class="n">num_top_sequences</span><span class="o">=</span><span class="n">num_top_sequences</span><span class="p">,</span>
            <span class="n">track_specific_sequences</span><span class="o">=</span><span class="n">track_specific_sequences</span><span class="p">,</span>
            <span class="n">genomic_positions</span><span class="o">=</span><span class="n">genomic_positions</span><span class="p">,</span>
            <span class="n">count_individuals_based_on_model</span><span class="o">=</span><span class="n">count_individuals_based_on_model</span><span class="p">,</span>
            <span class="n">save_to_file</span><span class="o">=</span><span class="n">save_data_to_file</span><span class="p">,</span> <span class="n">n_cores</span><span class="o">=</span><span class="n">n_cores</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span></div>


    <span class="c1">### Model interventions: ###</span>

<div class="viewcode-block" id="Model.newPopulation">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.newPopulation">[docs]</a>
    <span class="k">def</span> <span class="nf">newPopulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">setup_name</span><span class="p">,</span> <span class="n">num_hosts</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_vectors</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new Population object with setup parameters.</span>

<span class="sd">        If population ID is already in use, appends _2 to it</span>

<span class="sd">        Arguments:</span>
<span class="sd">            id (String): unique identifier for this population in the model.</span>
<span class="sd">            setup_name (Setup object): setup object with parameters for this population.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            num_hosts (int &gt;= 0): number of hosts to initialize population with. Defaults to 100.</span>
<span class="sd">            num_vectors (int &gt;= 0): number of vectors to initialize population with. Defaults to 100.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="nb">id</span><span class="o">+</span><span class="s1">&#39;_2&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">Population</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">setups</span><span class="p">[</span><span class="n">setup_name</span><span class="p">],</span> <span class="n">num_hosts</span><span class="p">,</span> <span class="n">num_vectors</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">setHostMigrationNeighbor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">setVectorMigrationNeighbor</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="mi">0</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">setHostHostPopulationContactNeighbor</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="mi">0</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">setVectorHostPopulationContactNeighbor</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="mi">0</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">setHostVectorPopulationContactNeighbor</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="mi">0</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">setHostMigrationNeighbor</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="nb">id</span><span class="p">],</span><span class="mi">0</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">setVectorMigrationNeighbor</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="nb">id</span><span class="p">],</span><span class="mi">0</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">setHostHostPopulationContactNeighbor</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="nb">id</span><span class="p">],</span><span class="mi">0</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">setVectorHostPopulationContactNeighbor</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="nb">id</span><span class="p">],</span><span class="mi">0</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">setHostVectorPopulationContactNeighbor</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="nb">id</span><span class="p">],</span><span class="mi">0</span>
                <span class="p">)</span></div>


<div class="viewcode-block" id="Model.linkPopulationsHostMigration">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.linkPopulationsHostMigration">[docs]</a>
    <span class="k">def</span> <span class="nf">linkPopulationsHostMigration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop1_id</span><span class="p">,</span> <span class="n">pop2_id</span><span class="p">,</span> <span class="n">rate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set host migration rate from one population towards another.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop1_id (String): origin population for which migration rate will be specified.</span>
<span class="sd">            pop1_id (String): destination population for which migration rate will be</span>
<span class="sd">                specified.</span>
<span class="sd">            rate (number &gt;= 0): migration rate from one population to the neighbor; evts/time.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop1_id</span><span class="p">]</span><span class="o">.</span><span class="n">setHostMigrationNeighbor</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop2_id</span><span class="p">],</span> <span class="n">rate</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.linkPopulationsVectorMigration">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.linkPopulationsVectorMigration">[docs]</a>
    <span class="k">def</span> <span class="nf">linkPopulationsVectorMigration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop1_id</span><span class="p">,</span> <span class="n">pop2_id</span><span class="p">,</span> <span class="n">rate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set vector migration rate from one population towards another.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop1_id (String): origin population for which migration rate will be specified.</span>
<span class="sd">            pop1_id (String): destination population for which migration rate will be</span>
<span class="sd">                specified.</span>
<span class="sd">            rate (number &gt;= 0): migration rate from one population to the neighbor; evts/time.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop1_id</span><span class="p">]</span><span class="o">.</span><span class="n">setVectorMigrationNeighbor</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop2_id</span><span class="p">],</span> <span class="n">rate</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.linkPopulationsHostHostContact">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.linkPopulationsHostHostContact">[docs]</a>
    <span class="k">def</span> <span class="nf">linkPopulationsHostHostContact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop1_id</span><span class="p">,</span> <span class="n">pop2_id</span><span class="p">,</span> <span class="n">rate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set host-host contact rate from one population towards another.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop1_id (String): origin population for which inter-population contact rate</span>
<span class="sd">                will be specified.</span>
<span class="sd">            pop1_id (String): destination population for which inter-population contact</span>
<span class="sd">                rate will be specified.</span>
<span class="sd">            rate (number &gt;= 0): inter-population contact rate from one population to the</span>
<span class="sd">                neighbor; evts/time.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop1_id</span><span class="p">]</span><span class="o">.</span><span class="n">setHostHostPopulationContactNeighbor</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop2_id</span><span class="p">],</span> <span class="n">rate</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.linkPopulationsHostVectorContact">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.linkPopulationsHostVectorContact">[docs]</a>
    <span class="k">def</span> <span class="nf">linkPopulationsHostVectorContact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop1_id</span><span class="p">,</span> <span class="n">pop2_id</span><span class="p">,</span> <span class="n">rate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set host-vector contact rate from one population towards another.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop1_id (String): origin population for which inter-population contact rate</span>
<span class="sd">                will be specified.</span>
<span class="sd">            pop1_id (String): destination population for which inter-population contact</span>
<span class="sd">                rate will be specified.</span>
<span class="sd">            rate (number &gt;= 0): inter-population contact rate from one population to the</span>
<span class="sd">                neighbor; evts/time.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop1_id</span><span class="p">]</span><span class="o">.</span><span class="n">setHostVectorPopulationContactNeighbor</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop2_id</span><span class="p">],</span> <span class="n">rate</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.linkPopulationsVectorHostContact">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.linkPopulationsVectorHostContact">[docs]</a>
    <span class="k">def</span> <span class="nf">linkPopulationsVectorHostContact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop1_id</span><span class="p">,</span> <span class="n">pop2_id</span><span class="p">,</span> <span class="n">rate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set vector-host contact rate from one population towards another.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop1_id (String): origin population for which inter-population contact rate</span>
<span class="sd">                will be specified.</span>
<span class="sd">            pop1_id (String): destination population for which inter-population contact</span>
<span class="sd">                rate will be specified.</span>
<span class="sd">            rate (number &gt;= 0): inter-population contact rate from one population to the</span>
<span class="sd">                neighbor; evts/time.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop1_id</span><span class="p">]</span><span class="o">.</span><span class="n">setVectorHostPopulationContactNeighbor</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop2_id</span><span class="p">],</span> <span class="n">rate</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.createInterconnectedPopulations">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.createInterconnectedPopulations">[docs]</a>
    <span class="k">def</span> <span class="nf">createInterconnectedPopulations</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">num_populations</span><span class="p">,</span> <span class="n">id_prefix</span><span class="p">,</span> <span class="n">setup_name</span><span class="p">,</span>
            <span class="n">host_migration_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vector_migration_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">host_host_contact_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">host_vector_contact_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vector_host_contact_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">num_hosts</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num_vectors</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create new populations, link all of them to each other.</span>

<span class="sd">        All populations in this cluster are linked with the same migration rate,</span>
<span class="sd">        starting number of hosts and vectors, and setup parameters. Their IDs</span>
<span class="sd">        are numbered onto prefix given as &#39;id_prefix_0&#39;, &#39;id_prefix_1&#39;,</span>
<span class="sd">        &#39;id_prefix_2&#39;, etc.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            num_populations (int): number of populations to be created.</span>
<span class="sd">            id_prefix (String): prefix for IDs to be used for this population in the model.</span>
<span class="sd">            setup_name (Setup object): setup object with parameters for all populations.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            host_migration_rate (number &gt;= 0): host migration rate between populations;</span>
<span class="sd">                evts/time. Defaults to 0.</span>
<span class="sd">            vector_migration_rate (number &gt;= 0): vector migration rate between populations;</span>
<span class="sd">                evts/time. Defaults to 0.</span>
<span class="sd">            host_host_contact_rate (number &gt;= 0): host-host inter-population contact rate</span>
<span class="sd">                between populations; evts/time. Defaults to 0.</span>
<span class="sd">            host_vector_contact_rate (number &gt;= 0): host-vector inter-population contact rate</span>
<span class="sd">                between populations; evts/time. Defaults to 0.</span>
<span class="sd">            vector_host_contact_rate (number &gt;= 0): vector-host inter-population contact rate</span>
<span class="sd">                between populations; evts/time. Defaults to 0.</span>
<span class="sd">            num_hosts (int): number of hosts to initialize population with. Defaults to 100.</span>
<span class="sd">            num_vectors (int): number of hosts to initialize population with. Defaults to 100.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">new_pops</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Population</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">id_prefix</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">setups</span><span class="p">[</span><span class="n">setup_name</span><span class="p">],</span>
                <span class="n">num_hosts</span><span class="p">,</span> <span class="n">num_vectors</span>
                <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_populations</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="n">new_pop_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">new_pops</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pop</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">id</span><span class="o">+</span><span class="s1">&#39;_2&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop</span>
            <span class="n">new_pop_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">:</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">setHostMigrationNeighbor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">setVectorMigrationNeighbor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">setHostHostPopulationContactNeighbor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">setHostVectorPopulationContactNeighbor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">pop</span><span class="o">.</span><span class="n">setVectorHostPopulationContactNeighbor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">setHostMigrationNeighbor</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">setVectorMigrationNeighbor</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">setHostHostPopulationContactNeighbor</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">setHostVectorPopulationContactNeighbor</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">setVectorHostPopulationContactNeighbor</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">p1_id</span> <span class="ow">in</span> <span class="n">new_pop_ids</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">p2_id</span> <span class="ow">in</span> <span class="n">new_pop_ids</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">linkPopulationsHostMigration</span><span class="p">(</span>
                    <span class="n">p1_id</span><span class="p">,</span><span class="n">p2_id</span><span class="p">,</span><span class="n">host_migration_rate</span>
                    <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">linkPopulationsVectorMigration</span><span class="p">(</span>
                    <span class="n">p1_id</span><span class="p">,</span><span class="n">p2_id</span><span class="p">,</span><span class="n">vector_migration_rate</span>
                    <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">linkPopulationsHostHostContact</span><span class="p">(</span>
                    <span class="n">p1_id</span><span class="p">,</span><span class="n">p2_id</span><span class="p">,</span><span class="n">host_host_contact_rate</span>
                    <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">linkPopulationsHostVectorContact</span><span class="p">(</span>
                    <span class="n">p1_id</span><span class="p">,</span><span class="n">p2_id</span><span class="p">,</span><span class="n">host_vector_contact_rate</span>
                    <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">linkPopulationsVectorHostContact</span><span class="p">(</span>
                    <span class="n">p1_id</span><span class="p">,</span><span class="n">p2_id</span><span class="p">,</span><span class="n">vector_host_contact_rate</span>
                    <span class="p">)</span></div>


<div class="viewcode-block" id="Model.newHostGroup">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.newHostGroup">[docs]</a>
    <span class="k">def</span> <span class="nf">newHostGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">group_id</span><span class="p">,</span> <span class="n">hosts</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of random hosts in population.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be sampled from.</span>
<span class="sd">            group_id (String): ID to name group with.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            hosts (number): number of hosts to be sampled randomly: if &lt;0, samples from</span>
<span class="sd">                whole population; if &lt;1, takes that fraction of population; if &gt;=1,</span>
<span class="sd">                samples that integer number of hosts. Defaults to -1.</span>
<span class="sd">            type (String = {&#39;healthy&#39;, &#39;infected&#39;, &#39;any&#39;}): whether to sample healthy hosts only, </span>
<span class="sd">                infected hosts only, or any hosts. Defaults to &#39;any&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list containing sampled hosts.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group_id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">newHostGroup</span><span class="p">(</span>
            <span class="n">hosts</span><span class="p">,</span> <span class="nb">type</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.newVectorGroup">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.newVectorGroup">[docs]</a>
    <span class="k">def</span> <span class="nf">newVectorGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">group_id</span><span class="p">,</span> <span class="n">vectors</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of random vectors in population.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be sampled from.</span>
<span class="sd">            group_id (String): ID to name group with.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            vectors (number): number of vectors to be sampled randomly: if &lt;0, samples from</span>
<span class="sd">                whole population; if &lt;1, takes that fraction of population; if &gt;=1,</span>
<span class="sd">                samples that integer number of vectors. Defaults to -1.</span>
<span class="sd">            type (String = {&#39;healthy&#39;, &#39;infected&#39;, &#39;any&#39;}): whether to sample healthy vectors only, infected vectors</span>
<span class="sd">                only, or any vectors. Defaults to &#39;any&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list containing sampled vectors.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group_id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">newVectorGroup</span><span class="p">(</span>
            <span class="n">vectors</span><span class="p">,</span> <span class="nb">type</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.addHosts">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.addHosts">[docs]</a>
    <span class="k">def</span> <span class="nf">addHosts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">num_hosts</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a number of healthy hosts to population, return list with them.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>
<span class="sd">            num_hosts (int): number of hosts to be added.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list containing new hosts.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">addHosts</span><span class="p">(</span><span class="n">num_hosts</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.addVectors">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.addVectors">[docs]</a>
    <span class="k">def</span> <span class="nf">addVectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">num_vectors</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a number of healthy vectors to population, return list with them.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>
<span class="sd">            num_vectors (int): number of vectors to be added.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list containing new vectors.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">addVectors</span><span class="p">(</span><span class="n">num_vectors</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.removeHosts">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.removeHosts">[docs]</a>
    <span class="k">def</span> <span class="nf">removeHosts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">num_hosts_or_list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a number of specified or random hosts from population.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>
<span class="sd">            num_hosts_or_list (int or list of Hosts): number of hosts to be sampled randomly for removal</span>
<span class="sd">                or list of hosts to be removed, must be hosts in this population.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">removeHosts</span><span class="p">(</span><span class="n">num_hosts_or_list</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.removeVectors">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.removeVectors">[docs]</a>
    <span class="k">def</span> <span class="nf">removeVectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">num_vectors_or_list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a number of specified or random vectors from population.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>
<span class="sd">            num_vectors_or_list (int or list of Vectors): number of vectors to be sampled randomly for</span>
<span class="sd">                removal or list of vectors to be removed, must be vectors in this</span>
<span class="sd">                population.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">removeVectors</span><span class="p">(</span><span class="n">num_vectors_or_list</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.addPathogensToHosts">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.addPathogensToHosts">[docs]</a>
    <span class="k">def</span> <span class="nf">addPathogensToHosts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">genomes_numbers</span><span class="p">,</span> <span class="n">group_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add specified pathogens to random hosts, optionally from a list.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>
<span class="sd">            genomes_numbers (dict with keys=Strings, values=int) dictionary containing pathogen </span>
<span class="sd">                genomes to add as keys and number of hosts each one will be added to as values.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            group_id (String): ID of specific hosts to sample from, if empty, samples</span>
<span class="sd">                from whole population. Defaults to &quot;&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">group_id</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">hosts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">hosts</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hosts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group_id</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">addPathogensToHosts</span><span class="p">(</span><span class="n">genomes_numbers</span><span class="p">,</span><span class="n">hosts</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.addPathogensToVectors">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.addPathogensToVectors">[docs]</a>
    <span class="k">def</span> <span class="nf">addPathogensToVectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">genomes_numbers</span><span class="p">,</span> <span class="n">group_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add specified pathogens to random vectors, optionally from a list.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>
<span class="sd">            genomes_numbers (dict with keys=Strings, values=int): dictionary containing pathogen </span>
<span class="sd">                genomes to add as keys and number of vectors each one will be added to as values.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            group_id (String): ID of specific vectors to sample from, if empty, samples</span>
<span class="sd">                from whole population. Defaults to &quot;&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">group_id</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">vectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">vectors</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group_id</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">addPathogensToVectors</span><span class="p">(</span><span class="n">genomes_numbers</span><span class="p">,</span><span class="n">vectors</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.treatHosts">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.treatHosts">[docs]</a>
    <span class="k">def</span> <span class="nf">treatHosts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">frac_hosts</span><span class="p">,</span> <span class="n">resistance_seqs</span><span class="p">,</span> <span class="n">group_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Treat random fraction of infected hosts against some infection.</span>

<span class="sd">        Removes all infections with genotypes susceptible to given treatment.</span>
<span class="sd">        Pathogens are removed if they are missing at least one of the sequences</span>
<span class="sd">        in resistance_seqs from their genome. Removes this organism from</span>
<span class="sd">        population infected list and adds to healthy list if appropriate.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>
<span class="sd">            frac_hosts (number between 0 and 1): fraction of hosts considered to be randomly selected.</span>
<span class="sd">            resistance_seqs (list of Strings): contains sequences required for treatment resistance.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            group_id (String): ID of specific hosts to sample from, if empty, samples</span>
<span class="sd">                from whole population. Defaults to &quot;&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">group_id</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">hosts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">hosts</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hosts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group_id</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">treatHosts</span><span class="p">(</span><span class="n">frac_hosts</span><span class="p">,</span><span class="n">resistance_seqs</span><span class="p">,</span><span class="n">hosts</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.treatVectors">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.treatVectors">[docs]</a>
    <span class="k">def</span> <span class="nf">treatVectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">frac_vectors</span><span class="p">,</span> <span class="n">resistance_seqs</span><span class="p">,</span> <span class="n">group_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Treat random fraction of infected vectors agains some infection.</span>

<span class="sd">        Removes all infections with genotypes susceptible to given treatment.</span>
<span class="sd">        Pathogens are removed if they are missing at least one of the sequences</span>
<span class="sd">        in resistance_seqs from their genome. Removes this organism from</span>
<span class="sd">        population infected list and adds to healthy list if appropriate.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>
<span class="sd">            frac_vectors (number between 0 and 1): fraction of vectors considered to be </span>
<span class="sd">                randomly selected.</span>
<span class="sd">            resistance_seqs (list of Strings): contains sequences required for treatment resistance.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            group_id (String): ID of specific vectors to sample from, if empty, samples</span>
<span class="sd">                from whole population. Defaults to &quot;&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">group_id</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">vectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">vectors</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group_id</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">treatVectors</span><span class="p">(</span>
            <span class="n">frac_vectors</span><span class="p">,</span><span class="n">resistance_seqs</span><span class="p">,</span><span class="n">vectors</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.protectHosts">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.protectHosts">[docs]</a>
    <span class="k">def</span> <span class="nf">protectHosts</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">frac_hosts</span><span class="p">,</span> <span class="n">protection_sequence</span><span class="p">,</span> <span class="n">group_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Protect a random fraction of infected hosts against some infection.</span>

<span class="sd">        Adds protection sequence specified to a random fraction of the hosts</span>
<span class="sd">        specified. Does not cure them if they are already infected.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>
<span class="sd">            frac_hosts (number between 0 and 1): fraction of hosts considered to be </span>
<span class="sd">                randomly selected.</span>
<span class="sd">            protection_sequence (String): sequence against which to protect.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            group_id (String): ID of specific hosts to sample from, if empty, samples</span>
<span class="sd">                from whole population. Defaults to &quot;&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">group_id</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">hosts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">hosts</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hosts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group_id</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">protectHosts</span><span class="p">(</span>
            <span class="n">frac_hosts</span><span class="p">,</span><span class="n">protection_sequence</span><span class="p">,</span><span class="n">hosts</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.protectVectors">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.protectVectors">[docs]</a>
    <span class="k">def</span> <span class="nf">protectVectors</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">frac_vectors</span><span class="p">,</span> <span class="n">protection_sequence</span><span class="p">,</span> <span class="n">group_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Protect a random fraction of infected vectors against some infection.</span>

<span class="sd">        Adds protection sequence specified to a random fraction of the vectors</span>
<span class="sd">        specified. Does not cure them if they are already infected.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>
<span class="sd">            frac_vectors (number between 0 and 1): fraction of vectors considered to be randomly selected.</span>
<span class="sd">            protection_sequence (String): sequence against which to protect.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            group_id (String): ID of specific vectors to sample from, if empty, samples</span>
<span class="sd">                from whole population. Defaults to &quot;&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">group_id</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">vectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">vectors</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group_id</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">protectVectors</span><span class="p">(</span>
            <span class="n">frac_vectors</span><span class="p">,</span><span class="n">protection_sequence</span><span class="p">,</span><span class="n">vectors</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Model.wipeProtectionHosts">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.wipeProtectionHosts">[docs]</a>
    <span class="k">def</span> <span class="nf">wipeProtectionHosts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">group_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes all protection sequences from hosts.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            group_id (String): ID of specific hosts to sample from, if empty, samples from</span>
<span class="sd">                whole from whole population. Defaults to &quot;&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">group_id</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">hosts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">hosts</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hosts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group_id</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">wipeProtectionHosts</span><span class="p">(</span><span class="n">hosts</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.wipeProtectionVectors">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.wipeProtectionVectors">[docs]</a>
    <span class="k">def</span> <span class="nf">wipeProtectionVectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">group_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes all protection sequences from vectors.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>

<span class="sd">        Keyword arguments:</span>
<span class="sd">            group_id (String): ID of specific vectors to sample from, if empty, samples</span>
<span class="sd">                from whole population. Defaults to &quot;&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">group_id</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">vectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">vectors</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">group_id</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">wipeProtectionVectors</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span></div>


    <span class="c1">### Modify population parameters: ###</span>

<div class="viewcode-block" id="Model.setSetup">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.setSetup">[docs]</a>
    <span class="k">def</span> <span class="nf">setSetup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_id</span><span class="p">,</span> <span class="n">setup_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assign parameters stored in Setup object to this population.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            pop_id (String): ID of population to be modified.</span>
<span class="sd">            setup_id (String): ID of setup to be assigned.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">[</span><span class="n">pop_id</span><span class="p">]</span><span class="o">.</span><span class="n">setSetup</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">setups</span><span class="p">[</span><span class="n">setup_id</span><span class="p">]</span> <span class="p">)</span></div>


    <span class="c1">### Utility: ###</span>

<div class="viewcode-block" id="Model.customModelFunction">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.customModelFunction">[docs]</a>
    <span class="k">def</span> <span class="nf">customModelFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns output of given function, passing this model as a parameter.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            function (callable): function to be evaluated; must take a Model object as the</span>
<span class="sd">                        only parameter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            output of function passed as parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


    <span class="c1">### Preset fitness functions: ###</span>

<div class="viewcode-block" id="Model.peakLandscape">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.peakLandscape">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">peakLandscape</span><span class="p">(</span><span class="n">genome</span><span class="p">,</span> <span class="n">peak_genome</span><span class="p">,</span> <span class="n">min_value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return genome phenotype by decreasing with distance from optimal seq.</span>

<span class="sd">        A purifying selection fitness function based on exponential decay of</span>
<span class="sd">        fitness as genomes move away from the optimal sequence. Distance is</span>
<span class="sd">        measured as percent Hamming distance from an optimal genome sequence.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            genome (String): the genome to be evaluated.</span>
<span class="sd">            peak_genome (String): the genome sequence to measure distance against, has</span>
<span class="sd">                value of 1.</span>
<span class="sd">            min_value (number 0-1): minimum value at maximum distance from optimal</span>
<span class="sd">                genome.</span>

<span class="sd">        Return:</span>
<span class="sd">            value of genome (number).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">distance</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">hamming</span><span class="p">(</span><span class="n">genome</span><span class="p">,</span> <span class="n">peak_genome</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">genome</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">min_value</span> <span class="p">)</span> <span class="o">*</span> <span class="n">distance</span> <span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="Model.valleyLandscape">
<a class="viewcode-back" href="../../opqua.html#opqua.model.Model.valleyLandscape">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">valleyLandscape</span><span class="p">(</span><span class="n">genome</span><span class="p">,</span> <span class="n">valley_genome</span><span class="p">,</span> <span class="n">min_value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return genome phenotype by increasing with distance from worst seq.</span>

<span class="sd">        A disruptive selection fitness function based on exponential decay of</span>
<span class="sd">        fitness as genomes move closer to the worst possible sequence. Distance</span>
<span class="sd">        is measured as percent Hamming distance from the worst possible genome</span>
<span class="sd">        sequence.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            genome (String): the genome to be evaluated.</span>
<span class="sd">            valley_genome (String): the genome sequence to measure distance against, has</span>
<span class="sd">                value of min_value.</span>
<span class="sd">            min_value (number 0-1): fitness value of worst possible genome.</span>

<span class="sd">        Return:</span>
<span class="sd">            value of genome (number).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">distance</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">hamming</span><span class="p">(</span><span class="n">genome</span><span class="p">,</span> <span class="n">valley_genome</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">genome</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">min_value</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">distance</span> <span class="p">)</span> <span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Pablo Cárdenas.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>